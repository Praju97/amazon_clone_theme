
function eventTrackerRss(gaval,category, action, label) {
    console.log('invoked for ' + category);
    ga(gaval,'event', category, action, label);
}
function setUserCookie(name, value, expires, path, domain, secure) {
  var chkcookiepolicy = getUserCookie('cookiePolicy');
  console.log(chkcookiepolicy);
  if(chkcookiepolicy !=0){
    var today = new Date();
    today.setTime(today.getTime());
    if (expires) {
        expires = expires * 1000 * 60 * 60;
    }

    var expires_date = new Date(today.getTime() + (expires));

    document.cookie = name + '=' + escape(value) +
        ((expires) ? ';expires=' + expires_date.toGMTString() : '') + //expires.toGMTString()
    ((path) ? ';path=' + path : '') +
        ((domain) ? ';domain=' + domain : '') +
        ((secure) ? ';secure' : '');
    }
}

function deleteUserCookie(name, path, domain) {
    if (getCookie(name)) document.cookie = name + '=' +
        ((path) ? ';path=' + path : '') +
        ((domain) ? ';domain=' + domain : '') +
        ';expires=Thu, 01-Jan-1970 00:00:01 GMT';
}
function checkUserCookie(cookie_name) {
    var location_details = getUserCookie(cookie_name);
    if (location_details == null || location_details == "") {
        return false;
    } else if (location_details != "") {
        return true;
    }
}
function getUserCookie(c_name) {
    var c_value = document.cookie;
    var c_start = c_value.indexOf(" " + c_name + "=");
    if (c_start == -1) {
        c_start = c_value.indexOf(c_name + "=");
    }
    if (c_start == -1) {
        c_value = null;
    } else {
        c_start = c_value.indexOf("=", c_start) + 1;
        var c_end = c_value.indexOf(";", c_start);
        if (c_end == -1) {
            c_end = c_value.length;
        }
        c_value = unescape(c_value.substring(c_start, c_end));
    }
    return c_value;
}
function removeQueryParamFromUrl(oldURL){
    var index = 0;
    var newURL = oldURL;
    index = oldURL.indexOf('?');
    if(index == -1){
        index = oldURL.indexOf('#');
    }
    if(index != -1){
        newURL = oldURL.substring(0, index);
    }
    return newURL;
}

/*var cookParam = 'cbse';
console.log("Cookie Value is : "+userCookie);
function getGlobalCookie(){
    var apiUrl = 'https://rss.oneindia.com/scripts/cms/global_cookie.php?globalval='+cookParam;
    fetch(apiUrl,{
        method: "post",
        credentials:"include"
    }).then(function(e) {
      e.text().then(function(data){
        console.log("Global Cookie Value is :"+data);
      });
    })["catch"](function(e) {
      console.log("Fetch Error :-S", e)
    });
}
getGlobalCookie();*/

if(document.getElementById("oiscripts")){
    var lang = document.getElementById("oiscripts").src.split("lang=")[1];
    if(lang != undefined && lang != null && lang !=''){
        var sitelang = lang.split('&')[0];
    }
}

var langObj = {
    'www': 'EN',
    'bengali': 'BN',
    'gujarati': 'GU',
    'hindi': 'HI',
    'kannada': 'KN',
    'tamil': 'TA',
    'malayalam': 'ML',
    'telugu': 'TE',
    'odia':'OD'
};
var hostObj = {
    'oneindia': 'OI',
    'boldsky': 'BS',
    'gizbot': 'GZ',
    'drivespark': 'DS',
    'filmibeat': 'FB',
    'goodreturns': 'GR',
    'careerindia': 'CI',
    'mykhel': 'MK',
    'nativeplanet': 'NP',
    'indiansutras': 'IS'
};
var popupCssMobi = "<style>.oi-article-popup-overlay{position:fixed;top:0;right:0;bottom:0;left:0;background:rgba(0,0,0,.5);z-index:1000000;display:none;}.oi-article-popup-wrapper{z-index:10000000;position:fixed;top:-150px;right:0;left:0;width:100%;background:#fff;font-family:'Open Sans',Arial,Helvetica,sans-serif;box-sizing:border-box;padding:15px 5px}.oi-article-popup-details{padding:0 5px;margin-left:125px}.oi-article-popup-thumbimg{float:left;width:120px}.oi-article-popup-thumbimg img{display:block;width:100%}.oi-article-popup-title{font-size:14px;color:#333;padding:5px 0;text-align:center;font-weight:600;min-height:30px;overflow:hidden}.oi-article-popup-title a{color:#333;text-decoration:none}.oi-article-popup-btn{padding:5px 0 0 0;text-align:center}.oi-article-popup-btn a{font-family:arial;font-size:12px;color:#fff;background:#0a3765;border-radius:5px;padding:7px 17px;display:inline-block;text-align:center;text-transform:uppercase;text-decoration:none;max-width:100px;word-spacing:normal;}.oi-article-popup-clear{text-align:center}.oi-article-popup-clear a{font-family:arial;font-size:12px;color:#a2a2a2;text-align:center;display:inline-block;padding:5px;text-transform:uppercase;text-decoration:underline}.oi-article-popup-close{position:absolute;right:0;top:0}.oi-article-popup-overlay.show-popup{display:block;}.oi-article-popup-wrapper.show-popup{top:0px;-webkit-transition: top 0.55s ease 0s;-moz-transition: top 0.55s ease 0s;-o-transition: top 0.55s ease 0s;transition: top 0.55s ease 0s;}</style>";
var popupCssWeb = "<style>.oi-article-popup-overlay{position:fixed;top:0;right:0;bottom:0;left:0;background:rgba(0,0,0,.5);z-index:1000000;display:none;}.oi-article-popup-wrapper{z-index:10000000;position:fixed;top:0;right:0;bottom:0;left:0;margin:auto;width:350px;height:400px;background:#fff;font-family:'Open Sans',Arial,Helvetica,sans-serif;border-radius:5px;display:none}.oi-article-popup-details{padding:5px}.oi-article-popup-thumbimg{border-radius:5px 5px 0 0}.oi-article-popup-thumbimg img{display:block;width:100%}.oi-article-popup-title{font-size:16px;color:#333;padding:10px 0;text-align:center;font-weight:600;line-height:20px;min-height:40px;}.oi-article-popup-title a{color:#333;text-decoration:none}.oi-article-popup-btn{padding:10px 0;width:80%;margin:0 auto;}.oi-article-popup-btn a{font-family:arial;font-size:14px;color:#fff;background:#e44f48;border-radius:10px;padding:10px;display:block;text-align:center;text-transform:uppercase;text-decoration:none}.oi-article-popup-clear{text-align:center}.oi-article-popup-clear a{font-family:arial;font-size:14px;color:#a2a2a2;text-align:center;display:inline-block;padding:5px;text-transform:uppercase;text-decoration:underline}.oi-article-popup-close{position:absolute;right:-5px;top:-5px}.oi-article-popup-overlay.show-popup,.oi-article-popup-wrapper.show-popup{display:block}</style>";
var popupHtmlWeb='';
var host = window.location.hostname;
var qparam = window.location.search;
var localKey = 'article_popup_shown';
var currentDate = new Date();
if(host!='' && host!=undefined){
    var domainParts = host.split('.');
    var langParam = langObj[domainParts[0]];
    var hostParam = hostObj[domainParts[1]];
    var domainmiddle = domainParts[1];
    var urlUtm = hostParam+'-'+langParam;
    var sitelang = langParam.toLowerCase();
}else{
    var urlUtm ='';
}
var oi_category_head='home';
if(document.querySelector('head').getAttribute('data-category_name')){
  oi_category_head=document.querySelector('head').getAttribute('data-category_name');
}
if(oi_category_head !='home' && oi_category_head !='index'){
  oi_category_head = 'article';
}

/*var promHost = ['tamil.gizbot.com','tamil.mykhel.com','tamil.oneindia.com','tamil.filmibeat.com','tamil.goodreturns.in','tamil.boldsky.com','tamil.drivespark.com'];
if(host.indexOf('tamil.')>'-1' && promHost.includes(host)){
    if(document.querySelectorAll('.image_listical').length>0){
      var prom_html = '';
      var image_elem = document.querySelectorAll('.image_listical')[1];
      if(image_elem !='' && image_elem != undefined && image_elem != null){
        var parent_elem = image_elem.parentElement;
        var promMedium = domainParts[1].charAt(0).toUpperCase()+domainParts[1].slice(1);
        var promUtm = 'utm_medium='+promMedium+'&utm_source='+urlUtm+'&utm_campaign=dacpromoters';
        var promurl = 'https://www.click.in/dac-promoters-homes/index.php?'+promUtm;
        prom_html+='<p><a href="'+promurl+'" target="_blank" rel="nofollow">நல்ல பிளாட் வாங்க நல்லா எடை போடுங்க.. 24 முதல் 26ம் தேதி வரை புக்கிங் மேளா.. வாங்க வாங்க!</></p>';
        var promDiv = document.createElement('div');
        promDiv.id = 'promDiv';
        promDiv.innerHTML = prom_html;
        parent_elem.appendChild(promDiv);
      }
    }
}*/
/*if(document.getElementById('endofcontent')){
  var channelLang = domainParts[0];
  if (/Mobi|Android/i.test(navigator.userAgent)) {
    var urlParam = '?utm_medium=Mobile&utm_source='+urlUtm+'&utm_campaign=Article-CoronaPromo';
    var coronaHtml = '<a href="https://'+channelLang+'.oneindia.com/topic/coronavirus'+urlParam+'" target="_blank"><img src="/images/corona-mobile.jpg" alt="COVID-19" /></a>';
  }else{
    var urlParam = '?utm_medium=Desktop&utm_source='+urlUtm+'&utm_campaign=Article-CoronaPromo';
    var coronaHtml = '<a href="https://'+channelLang+'.oneindia.com/topic/coronavirus'+urlParam+'" target="_blank"><img src="/images/corona-desktop.jpg" alt="COVID-19" /></a>';
  }
  document.getElementById("endofcontent").style.cssText = "clear: both;margin-top: 10px;text-align:center;";
  document.getElementById('endofcontent').innerHTML=coronaHtml;
}*/
/* Auto Deeplink Code - Starts */
if(domainmiddle != 'oneindia'){
var isDeeplinkExecute = 0;
var article_tags='';
function buildDeeplinkData(article_id,article_tag){
    if(article_tag !=''){
        var encode_article_tag=encodeURIComponent(article_tag);
    }else{
        var encode_article_tag=article_tag;
    }
    if (/Mobi|Android/i.test(navigator.userAgent)) {
    	var device_type='mobile';
    }else{
    	var device_type='computer';
    }
    var fetch_url = 'https://rss.oneindia.com/scripts/cms/cmsAPI.php?type=dynamic-deep-links&website='+host+'&id='+article_id+'&deviceType='+device_type+'&tags='+encode_article_tag;
    fetch(fetch_url,{
        method: "post"
        }).then(function(e) {
            e.text().then(function(data){
            	if(data !='' && data != undefined && data != null){
		              var parseData = JSON.parse(data);
		              var objlen = Object.keys(parseData).length;
		            if(objlen>0){
		                for (var key in parseData) {
		                    if (parseData.hasOwnProperty(key)) {
		                        var elem_id = 'deeplink_'+key;
		                        if(elem_id){
		                            var elemHtml =parseData[key]; 
		                            var element = document.getElementById(elem_id);
									element.insertAdjacentHTML("afterend",elemHtml);
									element.parentNode.removeChild(element);
		                            //$("div#"+elem_id).replaceWith(elemHtml);
		                        }
		                    }
		                }
		            }
        		}
          });
        })["catch"](function(e) {
            console.log("Fetch Error :-S", e)
        });
}
if(document.querySelector('.dynamic-deeplink')){
    if(document.getElementById("containerMain")) {
        var hasContentId = document.getElementById("containerMain").hasAttribute('data-content_id');
        var hasDeeplinkFlag = document.getElementById("containerMain").hasAttribute('data-deeplink_flag');
        if(hasContentId && hasDeeplinkFlag){
            var isContentId = document.getElementById("containerMain").getAttribute('data-content_id');
            var isDeeplinkFlag = document.getElementById("containerMain").getAttribute('data-deeplink_flag');
            if(isDeeplinkFlag==0){
                if((document.getElementById('tag-container'))&&(document.getElementById('tag-container').hasAttribute('data-tags'))){
                    article_tags=document.getElementById('tag-container').getAttribute('data-tags');
                }
                window.addEventListener('scroll', function(e) {
                    if(isDeeplinkExecute==0){
                        isDeeplinkExecute=1;
                        buildDeeplinkData(isContentId,article_tags);
                    }
                });
            }
        }
    }
}
}
/* Auto Deeplink Code - Ends */
function oiinsertAfter(referenceNode, newNode) {
  referenceNode.parentNode.insertBefore(newNode, referenceNode.nextSibling);
}
var oipromarticleHost = ['kannada.oneindia.com','hindi.oneindia.com','telugu.oneindia.com','kannada.filmibeat.com','hindi.filmibeat.com','telugu.filmibeat.com'];
var oiPromoCssMobi = "<style>.oi-promoarticlepage-relatedlink{background:#f5f5f5}.oiPromoArticle{padding:20px 20px 20px 20px;font-weight:700;font-size:15px;display:block;min-height:56px;line-height:21px;background:#f5f5f5}.oiPromoArticleImg{background-image:url(/images/oneindia-trans-logo-small.jpg);background-repeat:no-repeat;width:100px;min-height:56px;background-size:100% auto;background-position:center;float:right;margin-left:10px}.oiPromoArticle a{color:#06c}</style>";
var oiPromoCssWeb = "<style>.oiPromoArticle{padding:10px 0 15px 0;font-weight:700;min-height:60px;display:block}.oiPromoArticleImg{float:left;padding-right:10px;width:100px;height:56px}.oiPromoArticle a{color:#06c}</style>";
var oiPromoArray = {"kn": [{'url':'https://rb.gy/hzrfsc','title':'ಬಜಾಜ್ ಫೈನಾನ್ಸ್ ನಿಶ್ಚಿತ ಠೇವಣಿ ಮೇಲೆ ಹೂಡಿಕೆ ಮಾಡಿ ಮತ್ತು ಶೇ. 7.25%*ರಷ್ಟು ಮರಳಿ ಪಡೆಯಿರಿ.','image':'/images/bajaj_promo.jpeg'}], "hi": [{'url':'https://rb.gy/hzrfsc','title':'बजाज फिनांस फिक्स्ड डिपोजिट में निवेश कीजिए और पाइए 7.25%* तक निश्चित रिटर्न','image':'/images/bajaj_promo.jpeg'}],"te": [{'url':'https://rb.gy/hzrfsc','title':'బజాజ్ ఫైనాన్స్ ఫిక్స్డ్ డిపాజిట్లో పెట్టుబడులు పెట్టండి మరియు 7.25%* వరకు కచ్చితమైన రాబడిని పొందండి','image':'/images/bajaj_promo.jpeg'}],"ta": [{'url':'https://rb.gy/hzrfsc','title':'பஜாஜ் பினான்ஸ் நிரந்தர வைப்பு திட்டத்தில் முதலீடு செய்து 7.25%* வரை  ரிட்டர்ன்  பெறுங்கள்','image':'/images/bajaj_promo.jpeg'}],"ml": [{'url':'https://rb.gy/hzrfsc','title':'ബജാജ് ഫിനാൻസില്‍ സ്ഥിര നിക്ഷേപം നടത്തൂ, ഉറപ്പായ 7.25 ശതമാനം റിട്ടേണോട് കൂടി','image':'/images/bajaj_promo.jpeg'}],"en": [{'url':'https://rb.gy/hzrfsc','title':'Invest in Bajaj Finance Fixed Deposit and get assured returns up to 7.25%','image':'/images/bajaj_promo.jpeg'}],"bn": [{'url':'https://rb.gy/hzrfsc','title':'Invest in Bajaj Finance Fixed Deposit and get assured returns up to 7.25%','image':'/images/bajaj_promo.jpeg'}],"gu": [{'url':'https://rb.gy/hzrfsc','title':'Invest in Bajaj Finance Fixed Deposit and get assured returns up to 7.25%','image':'/images/bajaj_promo.jpeg'}],"od": [{'url':'https://rb.gy/hzrfsc','title':'Invest in Bajaj Finance Fixed Deposit and get assured returns up to 7.25%','image':'/images/bajaj_promo.jpeg'}]};

var oipromoarticle = (function(){
    return {
        oirandom: function (array) {
            return array[Math.random() * array.length | 0];
        },
        oigetRandomUrl:function(){
            var promourlArray = oiPromoArray[sitelang];
            var promourl = oipromoarticle.oirandom(promourlArray);
            return promourl;
        },
        fetchPromoData:function(){
            var promooiurl = oipromoarticle.oigetRandomUrl();
            var purl = promooiurl.url;
            var ptitle = promooiurl.title;
            var pimage ='https://rss.oneindia.com'+promooiurl.image; 
            if(document.querySelector('.promote_oi_articles')){
              var channelLang = domainParts[0];
              if (/Mobi|Android/i.test(navigator.userAgent)) {
              	var urlParam = purl+'?utm_source='+domainmiddle+'article&utm_medium=mobile&utm_campaign=mobile';
                var oipromoHtml = oiPromoCssMobi+'<span class="oiPromoArticle"><a href="'+urlParam+'" target="_blank"><img class="oiPromoArticleImg" src="'+pimage+'" alt="'+ptitle+'">'+ptitle+'</a></span>';
              }else{
              	var urlParam = purl+'?utm_source='+domainmiddle+'article&utm_medium=desktop&utm_campaign=desktop';
                var oipromoHtml = oiPromoCssWeb+'<div class="oi-promoarticlepage-relatedlink"><span class="oiPromoArticle"><a href="'+urlParam+'" target="_blank"><img class="oiPromoArticleImg" alt="'+ptitle+'" src="'+pimage+'">'+ptitle+'</a></span></div>';
              }
              var parentDiv = document.querySelector('.promote_oi_articles');
              var oipromoDiv = document.createElement('div');
              oipromoDiv.id = 'oipromoDiv';
              oipromoDiv.innerHTML = oipromoHtml;
              oiinsertAfter(parentDiv, oipromoDiv);
            }
        }
    };
})();
if(document.querySelector('.promote_oi_articles') && oipromarticleHost.includes(host)){
	var execpromo = 0;
    window.addEventListener('scroll', function(e) {
        if(execpromo==0){
            oipromoarticle.fetchPromoData();
            execpromo=1;
        }
    });
}
var notifyCssWeb = '<style>.oi-noti-image{height:56px;width:100px;overflow:hidden;vertical-align:middle;border-radius:6px 0 0 6px;text-align:center;float:left;padding:6px 0}.oi-noti-image img{max-width:100%;width:auto;height:100%}.oi-noti-site{color:grey;font-size:14px;line-height:14px;font-family:Arial}#oi-noti-wrapper{width:310px;border:0;bottom:10px;right:-200px;position:fixed;text-align:left;z-index:9999999999;-webkit-box-sizing:border-box;box-sizing:border-box;font-weight:400;border-radius:6px;-webkit-box-shadow:2px 2px 10px 2px hsla(0,0%,60%,.2);box-shadow:2px 2px 10px 2px hsla(0,0%,60%,.2);background-color:#fff;padding:5px;-moz-transition:all .27s ease-in;-o-transition:all .27s ease-in;-webkit-transition:all .27s ease-in;transition:all .27s ease-in;animation:mymove 2s;animation-fill-mode:forwards}@keyframes mymove{from{right:-200px}to{right:10px}}.oi-noti-content{float:right;width:200px;line-height: 18px;padding-top:5px;}.oi-noti-content p{padding:0;margin:0}.oi-noti-content a{text-decoration:none;font-size:14px}.oi-noti-image{height:56px;width:90px;overflow:hidden;vertical-align:middle;border-radius:6px 0 0 6px;text-align:center;float:left;padding-top:15px}#oi-noti-close{position:absolute;top:2px;right:2px;height:24px;width:24px;cursor:pointer;-webkit-transition:.2s ease-in-out;-o-transition:.2s ease-in-out;transition:.2s ease-in-out;-webkit-transform:rotate(45deg);-ms-transform:rotate(45deg);-o-transform:rotate(45deg);transform:rotate(45deg)}#oi-noti-close:after{content:"";display:block;background-color:gray;position:absolute;left:50%;top:50%;-webkit-transform:translate(-50%,-50%);-ms-transform:translate(-50%,-50%);-o-transform:translate(-50%,-50%);transform:translate(-50%,-50%)}#oi-noti-close:before{content:"";display:block;background-color:gray;position:absolute;left:50%;top:50%;-webkit-transform:translate(-50%,-50%);-ms-transform:translate(-50%,-50%);-o-transform:translate(-50%,-50%);transform:translate(-50%,-50%)}#oi-noti-close:before{width:12px;height:2px}#oi-noti-close:after{height:12px;width:2px}.oi-noti-content p span{display:block;padding:2px 0}.oi-noti-time{font-size:10px;opacity:.6;color:grey;font-family:Arial}.oi-noti-head{color:#2d2d2d;font-size:13px;line-height:17px;font-family:Arial}.oi-noti-head a{color:#2d2d2d;text-decoration:none}.oibrand{font-family:Arial;font-size:10px;color:#bebebe;float:left;font-weight:400;width:135px;line-height: 15px;}.oispons{font-family:Arial;font-size:10px;color:#bebebe;float:right;padding-right:10px!important;line-height: 15px;}</style>';
var notifyCssMobi='<style>.oi-noti-image{height:56px;width:100px;overflow:hidden;vertical-align:middle;border-radius:6px 0 0 6px;text-align:center;float:left;padding:6px 0}.oi-noti-image img{max-width:100%;width:auto;height:100%}.oi-noti-site{color:grey;font-size:14px;line-height:14px;font-family:Arial}#oi-noti-wrapper{width:99%;display:flex;margin:0 auto;border:0;top:-100px;left:0;right:0;position:fixed;text-align:left;z-index:99999999;-webkit-box-sizing:border-box;box-sizing:border-box;font-weight:400;border-radius:6px;-webkit-box-shadow:2px 2px 10px 2px hsla(0,0%,60%,.2);box-shadow:2px 2px 10px 2px hsla(0,0%,60%,.2);background-color:#fff;padding:5px;-moz-transition:all .27s ease-in;-o-transition:all .27s ease-in;-webkit-transition:all .27s ease-in;transition:all .27s ease-in;animation:mymove 2s;animation-fill-mode:forwards}@keyframes mymove{from{top:-100px}to{top:10px}}.oi-noti-content{float:left;width:215px;padding-top:6px;font-size:15px;}.oi-noti-content p{padding:0;margin:0}#oi-noti-close{position:absolute;top:2px;right:2px;height:24px;width:24px;cursor:pointer;-webkit-transition:.2s ease-in-out;-o-transition:.2s ease-in-out;transition:.2s ease-in-out;-webkit-transform:rotate(45deg);-ms-transform:rotate(45deg);-o-transform:rotate(45deg);transform:rotate(45deg)}#oi-noti-close:after{content:"";display:block;background-color:gray;position:absolute;left:50%;top:50%;-webkit-transform:translate(-50%,-50%);-ms-transform:translate(-50%,-50%);-o-transform:translate(-50%,-50%);transform:translate(-50%,-50%)}#oi-noti-close:before{content:"";display:block;background-color:gray;position:absolute;left:50%;top:50%;-webkit-transform:translate(-50%,-50%);-ms-transform:translate(-50%,-50%);-o-transform:translate(-50%,-50%);transform:translate(-50%,-50%)}#oi-noti-close:before{width:12px;height:2px}#oi-noti-close:after{height:12px;width:2px}.oi-noti-content p span{display:block;padding:2px 0}.oi-noti-time{font-size:10px;opacity:.6;color:grey;font-family:Arial}.oi-noti-head{color:#2d2d2d;font-size:13px;line-height:17px;font-family:Arial}.oi-noti-head a{color:#2d2d2d;text-decoration:none}.oibrand{font-family:Arial;font-size:10px;color:#bebebe;float:left;font-weight:400;width:135px;line-height:15px;}.oispons{font-family:Arial;font-size:10px;color:#bebebe;float:right;padding-right:10px!important;line-height:15px;}</style>';
var notifyHtmlWeb = '';
function oiNotioff(){
    if(document.getElementById("notifyDiv")){
        document.getElementById("notifyDiv").remove();
    }
}
function trackImp(impUrl){
  fetch(impUrl, {
          method: "GET"
        }).catch(function(err){
          console.error('Inside Imp error:', err);
        });
}
function getNotifyData(flg){
  var no_ads = 1;
      var device_type=flg;
      fetch("https://"+host+"/scripts/cms/controller.php?module=subscription&type=getAdgebraAd&last_sub_id=&device_type="+device_type+"&noAds="+no_ads+"&campid=",{
        method: "post"
        }).then(function(e) {
            e.text().then(function(data){
          adgebraResponse = data;
          if(adgebraResponse !='' && adgebraResponse !=undefined){
          var adgRes = JSON.parse(adgebraResponse);
          if(adgRes[0] !='' && adgRes[0] != undefined && adgRes[0] != null){
            //if(adgRes !='' && adgRes != undefined && adgRes != null){
                  var adgUrl = decodeURIComponent(adgRes[0]['trackerUrl']).replace(/\+/g,' ');
                  var adgTitle = decodeURIComponent(adgRes[0]['notificationMessage']).replace(/\+/g,' ');
                  var adgImg = adgRes[0]['notificationImage'];
                  var adCamp = adgRes[0]['campId'];
                  var adProvider = adgRes[0]['ad_provider'];
                  if (flg==2) {
                      notifyHtmlWeb+=notifyCssMobi;
                  }else{
                    notifyHtmlWeb+=notifyCssWeb;
                  }
                  notifyHtmlWeb+='<div id="oi-noti-wrapper"><div class="oi-noti-image"><a href="'+adgUrl+'" target="_blank"><img data-pagespeed-no-defer src="'+adgImg+'"></a></div> <div class="oi-noti-content"> <p><span class="oi-noti-site"></span> <span class="oi-noti-head"><a href="'+adgUrl+'" target="_blank">'+adgTitle+'</a></span></p></div> <span id="oi-noti-close" onclick="oiNotioff()"></span></div>';
                    var popupDiv = document.createElement('div');
                    popupDiv.id = 'notifyDiv';
                    popupDiv.innerHTML = notifyHtmlWeb;
                    document.getElementsByTagName('body')[0].appendChild(popupDiv);
                    setUserCookie('notify_flag',1,168,'/','','');
                    if(adProvider=='Veve'){
                      var impUrl = adgRes[0]['notificationImp'];
                      trackImp(impUrl);
                    }
                  setTimeout(function(){
                     if(document.getElementById("notifyDiv")){
                            document.getElementById("notifyDiv").remove();
                        }
                  },5000);
            }
            }
          });
        })["catch"](function(e) {
            console.log("Fetch Error :-S", e)
        });
}
function trackShown(trackurl,device_type,ntype){
    var apiurl = "https://"+host+"/scripts/cms/controller.php?module=subscription&type=notificationShown&url="+trackurl+"&device_type="+device_type;
    fetch(apiurl, {
          method: "post"
        }).catch(function(err){
          console.error('Inside Imp error:', err);
        });
}
function trackClick(trackurl,device_type,ntype){
      var apiurl = "https://"+host+"/scripts/cms/controller.php?module=subscription&type=notificationClicked&url="+trackurl+"&device_type="+device_type;
    fetch(apiurl, {
          method: "post"
        }).catch(function(err){
          console.error('Inside Imp error:', err);
        });
}
function getPromoNotification(flg){
		var promooiurl = oipromoarticle.oigetRandomUrl();
        var trackurl = promooiurl.url;//'https://www.gizbot.com/internet/features/biometric-data-security-how-safe-is-your-data-and-who-owns-it-072236.html'; 
        if (flg==2) {
          var adgUrl = decodeURIComponent(promooiurl.url+'?utm_source=pn-mobile&utm_medium=pn-bajaj&utm_campaign=pn-special-event').replace(/\+/g,' ');
        }else{
          var adgUrl = decodeURIComponent(promooiurl.url+'?utm_source=pn-desktop&utm_medium=pn-bajaj&utm_campaign=pn-special-event').replace(/\+/g,' ');
        }
        var adgTitle = promooiurl.title;
        var adgImg = 'https://rss.oneindia.com'+promooiurl.image;
        if (flg==2) {
            notifyHtmlWeb+=notifyCssMobi;
            var device_type = 'mobile';
        }else{
          notifyHtmlWeb+=notifyCssWeb;
          var device_type='computer';
        }
        var ntype = 'promarticle';
        notifyHtmlWeb+='<div id="oi-noti-wrapper"><div class="oi-noti-image"><a href="'+adgUrl+'" target="_blank"><img data-pagespeed-no-defer src="'+adgImg+'"></a></div> <div class="oi-noti-content"> <p><span class="oi-noti-site"></span> <span class="oi-noti-head"><a href="'+adgUrl+'" target="_blank">'+adgTitle+'</a></span></p></div> <span id="oi-noti-close" onclick="oiNotioff()"></span></div>';
          var popupDiv = document.createElement('div');
          popupDiv.id = 'notifyDiv';
          popupDiv.innerHTML = notifyHtmlWeb;
          document.getElementsByTagName('body')[0].appendChild(popupDiv);
          setUserCookie('promo_notify_flag',1,24,'/','','');
          trackShown(trackurl,device_type,ntype);
          popupDiv.onclick = function() { 
              trackClick(trackurl,device_type,ntype);
          };
        setTimeout(function(){
           if(document.getElementById("notifyDiv")){
                document.getElementById("notifyDiv").remove();
            }
        },5000);
}
var userClientIp = '';
var scrollTaboolaExecute = 0;
//if(host.indexOf('oneindia')> '-1'){
window.addEventListener("scroll", function(){
          if(scrollTaboolaExecute==0){
              scrollTaboolaExecute=1;
              if(document.body){
                    var gapiDetails = document.body.getAttribute('data-gapi');
                    if(gapiDetails){
                        var tmpgapijson = JSON.stringify(gapiDetails);
                        var jdata = gapiDetails;
                        jdata = JSON.parse(jdata);
                        console.log(jdata);
                        userClientIp = jdata.ip;
                        if (/Mobi|Android/i.test(navigator.userAgent)) {
                            var taboola_notify_flag = getUserCookie('taboola_notify_flag');
                              if(taboola_notify_flag == '' || taboola_notify_flag == null || taboola_notify_flag == "undefined"){
                                    getTaboolaNotifyData(2,userClientIp);
                              }
                            }else{
                              var taboola_notify_flag = getUserCookie('taboola_notify_flag');
                              if(taboola_notify_flag == '' || taboola_notify_flag == null || taboola_notify_flag == "undefined"){
                                    getTaboolaNotifyData(1,userClientIp);
                              }
                            }
                    }else{
                        getCountryCode();
                    }
                }
          }
      }, false);
//if(host=='bengali.oneindia.com' && window.location.search.indexOf('notify=1')>-1){
    
    
    var trackerConfigDetails = {
        userId:function(){
            var chars = "0123456789";
            var string_length = 26;
            var randomstring = '';
            for (var i=0; i<string_length; i++) {
                    var rnum = Math.floor(Math.random() * chars.length);
                    randomstring += chars.substring(rnum,rnum+1);
            }
            var ts = Math.round((new Date()).getTime() / 1000);
            return randomstring+'_'+ts;
        },
        getUserTrackerId:function(){
            var userTrackerId;
            var userTrackerIdCookie = getUserCookie('dp_user_trackerId');
            if(userTrackerIdCookie=="" || userTrackerIdCookie=="undefined" || userTrackerIdCookie==null){
                userTrackerIdCookie="";
            }
            if(userTrackerIdCookie!=''){
                userTrackerId = userTrackerIdCookie;
            }else{
                userTrackerId=trackerConfigDetails.userId();
                 var oi_tracker_cookie_lifespan = 87600;  // 3650 * 24
                var url = window.location.href;
                url_arr  = url.split('/');
                domain   = url_arr[2];
                lang_arr = domain.split('.');
                var cookie_domain = '.'+lang_arr[1]+'.'+lang_arr[2];
                setUserCookie('dp_user_trackerId', userTrackerId,oi_tracker_cookie_lifespan, '/', cookie_domain, '');
            }
            return userTrackerId;
        }
};
function getCountryCode(){
  fetch("https://gapi.oneindia.com/gapi",{
      method: "post"
      }).then(function(e) {
        e.text().then(function(data){
            if(data != '' && data != undefined && data != null){
              var jdata = data;
               jdata = JSON.parse(jdata);
               if(document.body){
                if(jdata != '' && jdata != undefined && jdata != null){
                  document.body.setAttribute("data-gapi",JSON.stringify(jdata));
                }
               }
               var st_code = jdata.State;
               var ct_code = jdata.city;
               userClientIp = jdata.ip;
               if (/Mobi|Android/i.test(navigator.userAgent)) {
                var taboola_notify_flag = getUserCookie('taboola_notify_flag');
                  if(taboola_notify_flag == '' || taboola_notify_flag == null || taboola_notify_flag == "undefined"){
                        getTaboolaNotifyData(2,userClientIp);
                  }
                }else{
                  var taboola_notify_flag = getUserCookie('taboola_notify_flag');
                  if(taboola_notify_flag == '' || taboola_notify_flag == null || taboola_notify_flag == "undefined"){
                        getTaboolaNotifyData(1,userClientIp);
                  }
                }
             }
        });

      })["catch"](function(e) {
        console.log("Fetch Error :-S", e);
    });
}
/*if(host=='bengali.oneindia.com' && window.location.search.indexOf('notify=1')>-1){
   function getCountryCode(){
  fetch("https://gapi.oneindia.com/gapi",{
      method: "post"
      }).then(function(e) {
        e.text().then(function(data){
            if(data != '' && data != undefined && data != null){
              var jdata = data;
               jdata = JSON.parse(jdata);
               if(document.body){
                if(jdata != '' && jdata != undefined && jdata != null){
                  document.body.setAttribute("data-gapi",JSON.stringify(jdata));
                }
               }
               var st_code = jdata.State;
               var ct_code = jdata.city;
               userClientIp = jdata.ip;
               if (/Mobi|Android/i.test(navigator.userAgent)) {
                var taboola_notify_flag = getUserCookie('taboola_notify_flag');
                  if(taboola_notify_flag == '' || taboola_notify_flag == null || taboola_notify_flag == "undefined"){
                        getTaboolaNotifyData(2,userClientIp);
                  }
                }else{
                  var taboola_notify_flag = getUserCookie('taboola_notify_flag');
                  if(taboola_notify_flag == '' || taboola_notify_flag == null || taboola_notify_flag == "undefined"){
                        getTaboolaNotifyData(1,userClientIp);
                  }
                }
             }
        });

      })["catch"](function(e) {
        console.log("Fetch Error :-S", e);
    });
} 
getCountryCode();
}*/
var usr_tracker_id = trackerConfigDetails.getUserTrackerId();
    
    function randomString(length) {
        var chars = '0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ';
        var result = '';
        for (var i = length; i > 0; --i) result += chars[Math.round(Math.random() * (chars.length - 1))];
        return result;
    }
function createTaboolaNotification(flg,responseTxt){
        if(responseTxt !='' && responseTxt != undefined && responseTxt != null){
                      var parseData = JSON.parse(responseTxt);

                      var objlen = Object.keys(parseData).length;
                    if(objlen>0){
                        var tmp_placement = parseData.placements[0];
                        var tmp_list = tmp_placement.list;
                        if(tmp_list.length>0){
                        var tmp_events = tmp_placement.events;
                        var tab_title = tmp_list[0].name;
                        var tab_url = tmp_list[0].url;
                        var tab_vis = tmp_events.visible;
                        var tab_avail=tmp_events.available;
                        var tab_img = tmp_list[0].thumbnail[0].url;
                        var tab_brand = tmp_list[0].branding;
                        trackImp(tab_avail);
                        if (flg==2) {
                            notifyHtmlWeb+=notifyCssMobi;
                            var device_type = 'mobile';
                        }else{
                          notifyHtmlWeb+=notifyCssWeb;
                          var device_type='computer';
                        }
                        var ntype = 'promarticle';
                        notifyHtmlWeb+='<div id="oi-noti-wrapper"><div class="oi-noti-image"><a href="'+tab_url+'" target="_blank"><img data-pagespeed-no-defer src="'+tab_img+'"></a></div> <div class="oi-noti-content"> <p><a href="'+tab_url+'" target="_blank"><span class="oi-noti-site"></span> <span class="oi-noti-head">'+tab_title+'</span><span class="oibrand">'+tab_brand+'</span><span class="oispons">[Sponsored]</span></a></p></div> <span id="oi-noti-close" onclick="oiNotioff()"></span></div>';
                          var popupDiv = document.createElement('div');
                          popupDiv.id = 'notifyDiv';
                          popupDiv.innerHTML = notifyHtmlWeb;
                          setTimeout(function(){
                              document.getElementsByTagName('body')[0].appendChild(popupDiv);
                              if(window.location.search.indexOf('notify=1')==-1){
                                setUserCookie('taboola_notify_flag',1,24,'/','','');
                              }
                              trackImp(tab_vis);
                              popupDiv.onclick = function() { 
                                    if(document.getElementById("notifyDiv")){
                                        document.getElementById("notifyDiv").remove();
                                    }
                              };
                                if (flg==2) {
                                setTimeout(function(){
				if(document.getElementById("notifyDiv")){
                                   document.getElementById("notifyDiv").remove();
				}
                                },5000);
                                }
                            },3000);
                    }
                }
                }
}
function getTaboolaNotifyData(deviceflag,userClientIp){
    console.log(userClientIp+":Client Side User IP.");
    var apiDetailsArr = {"bn":[{"pubid":"oneindiadigital-bengalipushnotification","web":"55ba2b3a15ac3e0c67244dd6abf0f431f69a9998","mobile":"63bb61c48292dec351977d160a4c5baac7b4403a"}],"gu":[{"pubid":"oneindiadigital-gujaratipushnotification","web":"55ba2b3a15ac3e0c67244dd6abf0f431f69a9998","mobile":"63bb61c48292dec351977d160a4c5baac7b4403a"}],"en":[{"pubid":"oneindiadigital-englishpushnotification","web":"55ba2b3a15ac3e0c67244dd6abf0f431f69a9998","mobile":"63bb61c48292dec351977d160a4c5baac7b4403a"}],"hi":[{"pubid":"oneindiadigital-hindipushnotification","web":"55ba2b3a15ac3e0c67244dd6abf0f431f69a9998","mobile":"63bb61c48292dec351977d160a4c5baac7b4403a"}],"ta":[{"pubid":"oneindiadigital-tamilpushnotification","web":"55ba2b3a15ac3e0c67244dd6abf0f431f69a9998","mobile":"63bb61c48292dec351977d160a4c5baac7b4403a"}],"kn":[{"pubid":"oneindiadigital-kannadapushnotification","web":"55ba2b3a15ac3e0c67244dd6abf0f431f69a9998","mobile":"63bb61c48292dec351977d160a4c5baac7b4403a"}],"ml":[{"pubid":"oneindiadigital-malayalampushnotification","web":"55ba2b3a15ac3e0c67244dd6abf0f431f69a9998","mobile":"63bb61c48292dec351977d160a4c5baac7b4403a"}],"te":[{"pubid":"oneindiadigital-telugupushnotification","web":"55ba2b3a15ac3e0c67244dd6abf0f431f69a9998","mobile":"63bb61c48292dec351977d160a4c5baac7b4403a"}],"od":[{"pubid":"oneindiadigital-englishpushnotification","web":"55ba2b3a15ac3e0c67244dd6abf0f431f69a9998","mobile":"63bb61c48292dec351977d160a4c5baac7b4403a"}]};
    var view_id = 'Home';
    var source_type = 'home';
    if (document.getElementById("containerMain") && document.getElementById("containerMain").hasAttribute("data-page_type")) {
        var pageType = document.getElementById("containerMain").getAttribute("data-page_type");
        if(pageType=='article'){
            view_id = 'Article';
            source_type = 'text';
        }else if(pageType=='homepage'){
            view_id = 'Home';
            source_type = 'home';
        }else{
            view_id='Section';
            source_type = 'section';
        }
    }
    var devicerandom = randomString(16);
    var uagent = navigator.userAgent;
    var pubId = apiDetailsArr[sitelang][0].pubid;
    if(deviceflag==1){
        var apiKeyTaboola = apiDetailsArr[sitelang][0].web;
        var appType = 'WEB';
    }else{
        var apiKeyTaboola = apiDetailsArr[sitelang][0].mobile;
        var appType = 'MOBILE';
    }
    var oReq = new XMLHttpRequest(),
    apiKey = '',
    baseUrl = 'https://api.taboola.com/2.0/json/'+pubId+'/',
    method = 'recommendations.get',
    url = baseUrl + method,
    request = {
        placements: [{
            name: host,
            recCount: 1,
            organicType: 'mix',
            thumbnail: {
                width: 100,
                height: 100
            }
        }],
        app: {
            type: appType,
            apiKey: apiKeyTaboola,
            origin: 'CLIENT'
        },
        user: {
            session: 'init',
            realip: userClientIp,
            agent: uagent,
            device: usr_tracker_id
        },
        source: {
            type: source_type,
            id: window.location.pathname,
            url: window.location.href
        },
        view: {
            id: view_id
        }
    };
oReq.open('POST', url, true);
oReq.onreadystatechange = function() {
    if (this.readyState == 4 && this.status == 200) {
        createTaboolaNotification(deviceflag,this.responseText)
    }
};
oReq.send(JSON.stringify(request));
}

//}
//if((host.indexOf('goodreturns.in')>'-1' || host.indexOf('mykhel.com')>'-1') && window.location.search.indexOf("oi_notify") > -1){
var city_arr = ['Machhagan','Bengaluru','Bangalore','Mumbai','Delhi','Ahmedabad','Chennai','Hyderabad','Kolkata','Pune','Howrah','GAUTAM BUDDHA NAGAR','Secunderabad','Ghaziabad','Faridabad','gurgaon','gurugram','noida','greater noida','navi mumbai','thane','New Delhi','Pimpri-Chinchwad','Dombivli','Kalyan','Mira Bhayandar','Ulhasnagar','Vasai','Virar','Mangalore'];
var state_arr = ['Odisha','Karnataka','Maharashtra','New Delhi','Gujarat','Tamil Nadu','Telangana','West Bengal','Uttar Pradesh','Haryana'];
var gapi_match_flag = false;
var gapi_details_flag = getUserCookie('gapi_match_flag');
function getCountryCode1(){
  fetch("https://gapi.oneindia.com/gapi",{
      method: "post"
      }).then(function(e) {
        e.text().then(function(data){
            if(data != '' && data != undefined && data != null){
              var jdata = data;
               jdata = JSON.parse(jdata);
               if(document.body){
                if(jdata != '' && jdata != undefined && jdata != null){
                  document.body.setAttribute("data-gapi",JSON.stringify(jdata));
                }
               }
               var st_code = jdata.State;
               var ct_code = jdata.city;
               userClientIp = jdata.ip;
             }
        });

      })["catch"](function(e) {
        console.log("Fetch Error :-S", e);
    });
}
/*if(host.indexOf('oneindia')== -1){
if(gapi_details_flag == '' || gapi_details_flag == null || gapi_details_flag == "undefined"){
if(document.body){
    var gapiDetails = document.body.getAttribute('data-gapi');
    if(gapiDetails){
        var tmpgapijson = JSON.stringify(gapiDetails);
    }else{
        getCountryCode();
    }
}
}
}*/
var mykhelHost = ['www.gizbot.com','tamil.gizbot.com','kannada.gizbot.com','telugu.gizbot.com','malayalam.gizbot.com','hindi.gizbot.com','www.mykhel.com','tamil.mykhel.com','kannada.mykhel.com','telugu.mykhel.com','kannada.oneindia.com','telugu.oneindia.com'];
//if(host.indexOf('goodreturns.in')>'-1' || host.indexOf('boldsky.com')>'-1' || host.indexOf('careerindia.com')>'-1' || mykhelHost.includes(host)){
var displayHour=[13,16];
var theDate=new Date();
var currentDay = Math.abs(theDate.getDate());
var currentHour = Math.abs(theDate.getHours());
var currentMonth = Math.abs(theDate.getMonth())+1;
/*if(currentHour>=displayHour[0] && currentHour<=displayHour[1]){
if (/Mobi|Android/i.test(navigator.userAgent)) {
    var notify_flag = getUserCookie('notify_flag');
    if(notify_flag == '' || notify_flag == null || notify_flag == "undefined"){
      setTimeout(function(){
        getNotifyData(2);
      },3000);
    }
}else{
  var notify_flag = getUserCookie('notify_flag');
  if(notify_flag == '' || notify_flag == null || notify_flag == "undefined"){
    setTimeout(function(){
      getNotifyData(1);
    },3000);
  }
}
}*/
var dataArr = [18,19,20];
var excludeHour=[13,14,15,16];
//if(window.location.search.indexOf('ref=promo')>-1){
//if(oipromarticleHost.includes(host)){
/*if (/Mobi|Android/i.test(navigator.userAgent)) {
var promo_notify_flag = getUserCookie('promo_notify_flag');
  if(promo_notify_flag == '' || promo_notify_flag == null || promo_notify_flag == "undefined"){
    //if(dataArr.includes(currentDay) && currentMonth==12 && excludeHour.indexOf(currentHour)==-1){
      //if(excludeHour.indexOf(currentHour)==-1){
        getPromoNotification(2);
      //}
  }
}else{
  var promo_notify_flag = getUserCookie('promo_notify_flag');
  if(promo_notify_flag == '' || promo_notify_flag == null || promo_notify_flag == "undefined"){
    //if(dataArr.includes(currentDay) && currentMonth==12 && excludeHour.indexOf(currentHour)==-1){
      //if(excludeHour.indexOf(currentHour)==-1){
        getPromoNotification(1);
      //}
  }
}*/
//}
//}
//}
//if(host.indexOf('www.goodreturns.in')>'-1'){
/*if (/Mobi|Android/i.test(navigator.userAgent)) {
    //Mobile Code Goes here...
}else{
  googletag.cmd.push(function() {
  googletag.pubads().addEventListener('slotRenderEnded', function(event) {
    var slotId = event.slot.getSlotElementId();
    if(slotId !='' && slotId != undefined && slotId != null){
        var elemClass = document.getElementById(slotId).parentNode.className;
        if(elemClass !='' && elemClass != undefined && elemClass != null){
            if((elemClass.indexOf('listical-ad-left')>'-1') || (elemClass.indexOf('listical-ad-right')>'-1')){
                  if(document.querySelector('.listical-ad-left')){
			document.querySelector('.listical-ad-left').setAttribute('style', 'width:auto !important;height:auto !important;');
                  }
                  if(document.querySelector('.listical-ad-right')){
			document.querySelector('.listical-ad-right').setAttribute('style', 'width:auto !important;height:auto !important;');
                  }
                  
            }
        }
    }
  });
});
}*/
//}
var promotedUrl = '';
var storedUrl='';
if(host.indexOf('oneindia')>'-1'){
  if (/Mobi|Android/i.test(navigator.userAgent)) {
    document.body.onclick = function (ev) {
        var clickElem = ev.target.getAttribute("class");
        if (clickElem == "hand hour" || clickElem == "hand sec" || clickElem=="hand min" || clickElem=="clock" || clickElem=="justin") {
              var gaParam = langObj[domainParts[0]];
              gaParam = gaParam.toLowerCase();
              var gaEventVal = 'oneindia'+gaParam+'.send';
              eventTrackerRss(gaEventVal,'just-in',oi_category_head,''); 
        }
    };
  }
}
var pctScrolled=0;
var mobileScrolled = 50;
var desktopScrolled=50;
var scrollExecute = 0;
var curLocUrl = window.location.origin + window.location.pathname;
function getDocHeight() {
    var D = document;
    return Math.max(
        D.body.scrollHeight, D.documentElement.scrollHeight,
        D.body.offsetHeight, D.documentElement.offsetHeight,
        D.body.clientHeight, D.documentElement.clientHeight
    )
}
function amountscrolled(){
    var winheight= window.innerHeight || (document.documentElement || document.body).clientHeight;
    var docheight = getDocHeight();
    var scrollTop = window.pageYOffset || (document.documentElement || document.body.parentNode || document.body).scrollTop;
    var trackLength = docheight - winheight;
    pctScrolled = Math.floor(scrollTop/trackLength * 100); // gets percentage scrolled (ie: 80 or NaN if tracklength == 0)
    
}
function closePopUp(){
    if(document.querySelector(".oi-article-popup-overlay")){
        var element1 = document.querySelector(".oi-article-popup-overlay");
        element1.classList.remove("show-popup");
    }
    if(document.querySelector(".oi-article-popup-wrapper")){
        var element2 = document.querySelector(".oi-article-popup-wrapper");
        element2.classList.remove("show-popup");
    }
    //document.body.style.overflow = "auto";
}
function getHourDiff(timestamp1, timestamp2) {
    var diff = timestamp2.valueOf() - timestamp1.valueOf();
    var diffInHours = Math.abs(Math.floor(diff/60/60));
    return diffInHours;
}
function getPopupData(hname,device){
    var headers = new Headers();
    headers.append('Content-Type', 'application/json');
    headers.append('cache-control', 'max-age=0, no-cache, no-store, no-transform');

var options = {
    headers: headers
};
    var today = new Date();
    var urlBurstParam = today.getHours();
    //var urlBurstParam = new Date().getTime();//Math.floor(Math.random()*10000) + 1;//today.getHours();
    var apiUrl = 'https://'+hname+'/common/article-popup.json?v='+urlBurstParam;
    fetch(apiUrl,options)
    .then(response => {
      return response.json()
    })
    .then(data => {
        if(data != undefined && data !='' && data != null){
              var finalJsonData = data['article_popup_link'];
              if(finalJsonData.length>0){
                  var articlepopupstory=localStorage.getItem('article-popup-story');
                  if(articlepopupstory=="" || articlepopupstory=="undefined" || articlepopupstory==null){
                    articlepopupstory = "";
                  }
                  storedUrl = articlepopupstory;
                  var curUrl = window.location.origin + window.location.pathname;
                  var nodeJsonData = finalJsonData[0];
                  var urlParam = '?utm_medium='+device+'&utm_source='+urlUtm+'&utm_campaign=Special-Story-Promo';
                  if(nodeJsonData['url'] != '#'){
                  var updateddate = data['updated_at'];
                  if(updateddate != undefined && updateddate != null && updateddate != ''){
                      var timeStamp = Math.floor(Date.now() / 1000);
                      var hourDiff = getHourDiff(timeStamp,updateddate);
                  }else{
                      var hourDiff = 0;
                  }
                  console.log(hourDiff);
                  var articleUrl = removeQueryParamFromUrl(nodeJsonData['url']);
                  promotedUrl = articleUrl;
			console.log(curLocUrl);
                  if(hourDiff <= 24){
                  if((curLocUrl != articleUrl) && (articlepopupstory=="" || articlepopupstory != articleUrl)){
                  var url = nodeJsonData['url']+urlParam;
                  var heading = nodeJsonData['heading'];
                  var image = nodeJsonData['mobi_image'];
                  if(device=='Mobile'){
                    image = image.replace('/img/','/img/120x99/');
                    popupHtmlWeb+=popupCssMobi;
                    var noThanks ='';
                  }else{
                    image = image.replace('/img/','/img/300x99/');
                    popupHtmlWeb+=popupCssWeb;
                    var noThanks = '<div class="oi-article-popup-clear"><a href="javascript:void(0);" class="clear-txt">No Thanks</a></div>';
                  }
                  
                  //document.body.style.overflow = "hidden";
                  
                  if(device=='Mobile'){
                    popupHtmlWeb+='<div class="oi-article-popup-wrapper"><a href="javascript:void(0);" class="oi-article-popup-close"><img src="/images/close-btn.svg" alt="" class="close-img" height="22" width="22"/></a><div class="oi-article-popup-thumbimg"><a href="'+url+'"><img src="'+image+'" alt=""  /></a></div><div class="oi-article-popup-details"><div class="oi-article-popup-title"><a href="'+url+'">"'+heading+'"</a></div><div class="oi-article-popup-btn"><a href="'+url+'">Read Story</a></div>'+noThanks+'</div></div>';
                    var popupDiv = document.createElement('div');
                    popupDiv.id = 'popupDiv';
                    popupDiv.innerHTML = popupHtmlWeb;
                    document.getElementsByTagName('body')[0].appendChild(popupDiv);
                    setTimeout(function(){
                      //var element1 = document.querySelector(".oi-article-popup-overlay");
                      //element1.classList.add("show-popup");
                      var element2 = document.querySelector(".oi-article-popup-wrapper");
                      element2.classList.add("show-popup");
                      localStorage.setItem(localKey,currentDate.getTime());
                      localStorage.setItem('article-popup-story',articleUrl);
                    },8000);
                  }else{
                    popupHtmlWeb+='<div class="oi-article-popup-overlay show-popup"></div><div class="oi-article-popup-wrapper show-popup"><a href="javascript:void(0);" class="oi-article-popup-close"><img src="/images/close-btn.svg" alt="" class="close-img" height="22" width="22"/></a><div class="oi-article-popup-thumbimg"><a href="'+url+'"><img src="'+image+'" alt=""  /></a></div><div class="oi-article-popup-details"><div class="oi-article-popup-title"><a href="'+url+'">"'+heading+'"</a></div><div class="oi-article-popup-btn"><a href="'+url+'">Read Story</a></div>'+noThanks+'</div></div>';
                    setTimeout(function(){
                      var popupDiv = document.createElement('div');
                      popupDiv.id = 'popupDiv';
                      popupDiv.innerHTML = popupHtmlWeb;
                      document.getElementsByTagName('body')[0].appendChild(popupDiv);
                      localStorage.setItem(localKey,currentDate.getTime());
                      localStorage.setItem('article-popup-story',nodeJsonData['url']);
                    },8000);
                  }
                  document.body.onclick = function (ev) {
                      var clickElem = ev.target.getAttribute("class");
                      if (clickElem == "clear-txt" || clickElem == "close-img") {
                            closePopUp(); 
                      }
                    };
                }
              }else{
                if(device=='Desktop'){
                  localStorage.setItem('article-popup-story',nodeJsonData['url']);
                }
              }
              }
              }
        }
    })
    .catch(err => {
      // Do something for an error here
    })
}
if (document.getElementById("containerMain")) {
    var pageType = document.getElementById("containerMain").getAttribute("data-page_type");
    //if (pageType != 'homepage') {
//if((host.indexOf('oneindia')>'-1') && (qparam.indexOf('popup=1')>'-1')){ //For Disable
if((host.indexOf('oneindia')>'-1')){ //For Enable
  if (/Mobi|Android/i.test(navigator.userAgent)) {
    var lastShownTs=+localStorage.getItem(localKey);
    console.log(lastShownTs);
    if(lastShownTs=="" || lastShownTs=="undefined" || lastShownTs==null){
      lastShownTs = "";
    }
    
    currentDate.setHours(0, 0, 0, 0);
    var lastShown = null;
    if (!isNaN(lastShownTs)) {
      lastShown = new Date(lastShownTs);
      lastShown.setHours(0, 0, 0, 0);
    }
    //if(lastShown == null || lastShown.getTime() != currentDate.getTime()){
	window.addEventListener("scroll", function(){
          amountscrolled();
          if(scrollExecute==0){
             //console.log(pctScrolled + '% scrolled');
            if(pctScrolled >= mobileScrolled){
              scrollExecute=1;
              if(!document.getElementById('notifyDiv')){
                getPopupData(host,'Mobile');
              }
            }
          }
      }, false);
    //}
  }else{
    console.log("Desktop Device........");
    var lastShownTs=+localStorage.getItem(localKey);
    console.log(lastShownTs);
    if(lastShownTs=="" || lastShownTs=="undefined" || lastShownTs==null){
      lastShownTs = "";
    }
    var currentDate = new Date();
    currentDate.setHours(0, 0, 0, 0);
    var lastShown = null;
    if (!isNaN(lastShownTs)) {
      lastShown = new Date(lastShownTs);
      lastShown.setHours(0, 0, 0, 0);
    }
    //if(lastShown == null || lastShown.getTime() != currentDate.getTime()){
        //setTimeout(function(){
            window.addEventListener("scroll", function(){
          amountscrolled();
          if(scrollExecute==0){
             //console.log(pctScrolled + '% scrolled');
            if(pctScrolled >= desktopScrolled){
              scrollExecute=1;
              if(!document.getElementById('notifyDiv')){
                getPopupData(host,'Desktop');
              }
            }
          }
      }, false);
        //},8000);
    //}
  }
}
//}
}
if(document.getElementById("ele-predication-wrapper")){
if(typeof(require)=='undefined'){
    var elecPromoArray = {"en": ["https://www.oneindia.com/scripts/chhattisgarh-election-2018/index.php?page=connector", "https://www.oneindia.com/scripts/madhyapradesh-election-2018/index.php?page=connector", "https://www.oneindia.com/scripts/rajasthan-election-2018/index.php?page=connector","https://www.oneindia.com/scripts/telangana-election-2018/index.php?page=connector"], "hi": ["https://hindi.oneindia.com/scripts/chhattisgarh-election-2018/index.php?page=connector","https://hindi.oneindia.com/scripts/madhyapradesh-election-2018/index.php?page=connector","https://hindi.oneindia.com/scripts/rajasthan-election-2018/index.php?page=connector","https://hindi.oneindia.com/scripts/telangana-election-2018/index.php?page=connector"],"te": ["https://telugu.oneindia.com/scripts/telangana-election-2018/index.php?page=connector"]};
var oisettings = (function(){
    return {
        random: function (array) {
            return array[Math.random() * array.length | 0];
        },
        getRandomUrl:function(){
            var urlArray = elecPromoArray[sitelang];
            var url = oisettings.random(urlArray);
            return url;
        },
        fetchElectionData:function(){
            var url = oisettings.getRandomUrl();
            $.ajax({
                'async': false,
                'url': url,
                'success': function(data) {
                    if(data){
                        //console.log(data);
                        document.getElementById("ele-predication-wrapper").innerHTML=data;
                    }
                }
            });
        },
        electionPromo:function(){
            var exec = 0;
            window.addEventListener('scroll', function(e) {
                if(exec==0){
                    //console.log(elecPromoArray);
                    oisettings.fetchElectionData();
                    exec=1;
                }
            });
        }
    };
})();
if(document.getElementById("ele-predication-wrapper")){
    oisettings.electionPromo();
}
}else{
    require(["jquery"], function() {
        var elecPromoArray = {"en": ["https://www.oneindia.com/scripts/chhattisgarh-election-2018/index.php?page=connector", "https://www.oneindia.com/scripts/madhyapradesh-election-2018/index.php?page=connector", "https://www.oneindia.com/scripts/rajasthan-election-2018/index.php?page=connector","https://www.oneindia.com/scripts/telangana-election-2018/index.php?page=connector"], "hi": ["https://hindi.oneindia.com/scripts/chhattisgarh-election-2018/index.php?page=connector","https://hindi.oneindia.com/scripts/madhyapradesh-election-2018/index.php?page=connector","https://hindi.oneindia.com/scripts/rajasthan-election-2018/index.php?page=connector","https://hindi.oneindia.com/scripts/telangana-election-2018/index.php?page=connector"],"te": ["https://telugu.oneindia.com/scripts/telangana-election-2018/index.php?page=connector"]};
var oisettings = (function(){
    return {
        random: function (array) {
            return array[Math.random() * array.length | 0];
        },
        getRandomUrl:function(){
            var urlArray = elecPromoArray[sitelang];
            var url = oisettings.random(urlArray);
            return url;
        },
        fetchElectionData:function(){
            var url = oisettings.getRandomUrl();
            $.ajax({
                'async': false,
                'url': url,
                'success': function(data) {
                    if(data){
                       // console.log(data);
                        document.getElementById("ele-predication-wrapper").innerHTML=data;
                    }
                }
            });
        },
        electionPromo:function(){
            var exec = 0;
            window.addEventListener('scroll', function(e) {
                if(exec==0){
                    //console.log(elecPromoArray);
                    oisettings.fetchElectionData();
                    exec=1;
                }
            });
        }
    };
})();
if(document.getElementById("ele-predication-wrapper")){
    oisettings.electionPromo();
}
    });
}
}
/*console.log(typeof require);
//For Displaying Javascript Error in Console by passing 'oi_error_console' as Query Parameter
if(window.location.search.indexOf("oi_error_console") > -1){
    window.onerror = function (msg, url, lineNo, columnNo, error) {
        var string = msg.toLowerCase();
        var substring = "script error";
        if (string.indexOf(substring) > -1){
            console.log('Script Error: See Browser Console for Detail');
        } else {
            var data = [
                { Message: msg, URL: url, Line: lineNo,Column:columnNo }
            ];
        console.table(data);
        }
        return false;
    };
}*/


var element = document.createElement("link");
element.setAttribute("rel", "stylesheet");
element.setAttribute("type", "text/css");
element.setAttribute("href", "https://rss.oneindia.com/common/oi-common-all-style.css?v=1.0.9");
document.getElementsByTagName("head")[0].appendChild(element);
/*Live Video Logic*/

(function (window, document, undefined) {
var liveVideoPromotion = function () {
      if(typeof require=='function'){
            if (document.getElementById("containerMain")) {
            var pageType = document.getElementById("containerMain").getAttribute("data-page_type");
            if (pageType == 'homepage') {
                try {
                  require(["jquery", "jqvisible"], function($) {
                      if ($("#livevideopromo").length > 0) {
                          $("#livevideopromo").attr('data-changed',0);
                          var isRun = 0;
                          var clean_uri='';
                          var vidSrc = $('#livevideopromo').find('iframe').attr('src');
                          if(vidSrc!=undefined && vidSrc != null && vidSrc !=''){
                            $(window).on("scroll", function(e) {
                              var elemVisible = $('#livevideopromo').visible(true);
                              var changedVal = $('#livevideopromo').attr('data-changed');
                              if(isRun==0){
                                if (elemVisible) {
                                  if(changedVal==1){
                                    $('#livevideopromo').find('iframe').attr('src',vidSrc);
                                    $("#livevideopromo").attr('data-changed',0);
                                  }
                                }else{
                                   if(changedVal==0){
                                      if (vidSrc.indexOf("?") > 0) {
                                          clean_uri = vidSrc.substring(0, vidSrc.indexOf("?"));
                                      }else{
                                          clean_uri = vidSrc;
                                      }
                                      clean_uri = clean_uri+'?autoplay=false&mute=1';
                                      $('#livevideopromo').find('iframe').attr('src',clean_uri);
                                      $("#livevideopromo").attr('data-changed',1);
                                    }
                                }
                              }
                              
                          });
                          }
                      }
                  });
                } catch (err) {
                    console.log('Live Video Home page Block : ' + err);
                }
          }
        }
      }
}
window.liveVideoPromotion = liveVideoPromotion;
})(window, document);
console.log(typeof require);
var liveVideoExec = 0;
window.addEventListener('scroll', function(e) {
    if(liveVideoExec==0){
        //console.log(elecPromoArray);
        window.liveVideoPromotion();
        liveVideoExec=1;
    }
});
/*AD Logic For Dynamic Slot Creation*/
(function (window, document, undefined) {
var injectDynamicSlotAd = function (dslotpos,dynamicSlotId,curId) {
  console.log(window.googletag);
  console.log(googletag.apiReady);
  if (window.googletag && googletag.apiReady) {
    googletag.cmd.push(function(){
                if(dslotpos % 2==0){
                    slot[dslotpos] = googletag.defineSlot('/1008496/GIT-IA-ROS-300x250-2', [[300, 250]],dynamicSlotId).addService(googletag.pubads());
                }else{
                    slot[dslotpos] = googletag.defineSlot('/1008496/GIT-IA-ROS-300x250-1', [[300, 250]],dynamicSlotId).addService(googletag.pubads());
                }
                googletag.pubads().enableSingleRequest();
                // googletag.pubads().enableAsyncRendering();
                // googletag.pubads().collapseEmptyDivs();
                 googletag.enableServices();
                googletag.display(curId);
		googletag.pubads().refresh([slot[dslotpos]]);
        });
  }
}
window.injectDynamicSlotAd = injectDynamicSlotAd;
})(window, document);
/*AD Logic For Dynamic Slot Creation*/
/*ADs Logic for Polls*/

function isVisible(domElement) {
  return new Promise(resolve => {
    const o = new IntersectionObserver(([entry]) => {
      resolve(entry.intersectionRatio >= 0.5);
      o.disconnect();
    });
    o.observe(domElement);
  });
}


var dynamicSlot=[];
var elemVis;
(function (window, document, undefined) {
var injectDynamicAd = function (adDiv,adload,adSts,idx) {
            //console.log(adDiv+" Ad Div For Polls");
            var elemInViewPort = isVisible(document.getElementById('oneindia_polls_container'));
            var dslotpos = parseInt(idx)+100;
            var dynamicSlotId =  "div-gpt-ad-1468987604107-"+dslotpos;
            var dynamicDiv = '<div class="poll-adv-block"><div class="poll-adv-heading">Advertisement</div><div id="'+dynamicSlotId+'" data-elementid="'+dslotpos+'" style="width:300px;height:250px;"></div></div>';
            document.getElementById(adDiv).innerHTML = dynamicDiv;
            var targetSlotPos = 'DYNAMIC-'+idx;
            var activeWindow = document.body.classList.contains('visible');
            if(activeWindow){
                var isPaused = false;
            }else{
                var isPaused = true;
            }
            
            if(adSts){
                if(adload==undefined){
                    if(!isPaused){
                      elemInViewPort.then(vals => { 
                          if(vals){
                              googletag.cmd.push(function(){
                                    dynamicSlot[dslotpos] = googletag.defineSlot('/1008496/GIT-IA4', [[300, 250]],dynamicSlotId).addService(googletag.pubads());
                                    dynamicSlot[dslotpos].setTargeting('position',['M1']);
                                    dynamicSlot[dslotpos].setTargeting('scroll',[targetSlotPos]); 
                                    googletag.pubads().enableSingleRequest();
                                     googletag.pubads().enableAsyncRendering();
                                     googletag.pubads().collapseEmptyDivs();
                                     googletag.enableServices();
                                    googletag.display(dynamicSlotId);
                              });
                              document.getElementById(adDiv).setAttribute('data-adloaded',1);
                          }
                        }); 
                    }
                }else{
                    if(document.getElementById(adDiv)){
                          if(!isPaused){
                            elemInViewPort.then(vals => { 
                              if(vals){
                                googletag.pubads().refresh([dynamicSlot[dslotpos]]);
                              }
                            }); 
                          }
                    }
                }
            }
          //}
    }
window.injectDynamicAd = injectDynamicAd;
})(window, document);
var oiobj = (function(){
    return {
        fetchBidDetails :function () {
              (function() {
              function forEach(responses, cb) {
                console.log(responses);
                Object.keys(responses).forEach(function(adUnitCode) {
                  var response = responses[adUnitCode];
                  response.bids.forEach(function(bid) {
                    cb(adUnitCode, bid);
                  });
                });
              }
              var winners = pbjs.getAllWinningBids();
              var winningLen = winners.length;

              var output = [];
              forEach(pbjs.getBidResponses(), function(code, bid) {
                output.push({
                  bid: bid,
                  adunit: code,
                  adId: bid.adId,
                  bidder: bid.bidder,
                  time: bid.timeToRespond,
                  //cpm: bid.cpm,
                  creativeId:bid.creativeId,
                  msg: bid.statusMessage,
                  rendered: !!winners.find(function(winner)
             {
                    return winner.adId==bid.adId;
                  })
                });
              });
              forEach(pbjs.getNoBids && pbjs.getNoBids() || {}, function(code, bid) {
                output.push({
                  msg: "no bid",
                  adunit: code,
                  adId: bid.bidId,
                  bidder: bid.bidder
                });
              });
              var outputCss = '.ad-overlay{position:absolute;left:0;right:0;bottom:0;top:0;background:#f7f8e0;overflow:hidden;box-sizing:border-box;opacity:.8;z-index:2147483643;border-width:0 0 0 12px;border-style:solid;border-color:#ff5722;text-align:left;font-size:12px;line-height:18px;font-family:arial;padding:10px 20px}#oiBottomAd{position:fixed;bottom:0;z-index:10000000000;width:100%;height:70px;margin:0 auto;border:1px solid #dbdbdb;background:#f7f8e0}.close-ad{position:absolute;right:6px;top:-20px;width:20px;height:20px;background:#000;z-index:10000000;cursor:pointer;color:#fff;font-size:14px;font-weight:700;text-align:center;border-radius:50%;font-family:Arial;line-height:20px}#oiBottomAdHeading{font-family:Arial;font-size:14px;color:#999;text-align:center;padding:20px 0}';
              var style = document.createElement('style');
            style.type = 'text/css';
            style.innerHTML = outputCss;
            document.getElementsByTagName('head')[0].appendChild(style);
              if (output.length) {
                  //if(displayFlg==0){
                    for (var j = 0; j < output.length; j++) {
                        if(output[j].rendered){
                          var elemName = output[j].adunit;
                          var divElm = adElem[0][elemName];
                          var elemId = divElm+"-overlay";
                          var item = document.getElementById(elemId);
                          if(item){
                            item.parentNode.removeChild(item);
                          }
                          var adHtml='<span><b>'+divElm+'</b></span><br><span><b>'+output[j].adunit+'</b></span><br><span>Bidder: </span><a>'+output[j].bidder+'</a><br><span>Ad Id: </span><a>'+output[j].adId+'</a><br><span>Creative Id: </span><a>'+output[j].creativeId+'</a>';
                          var newItem = document.createElement("div");
                          newItem.className = "ad-overlay";
                          newItem.id = divElm+"-overlay";
                          newItem.innerHTML=adHtml;
                          console.log(newItem);
                          var list = document.getElementById(divElm);
                          list.insertBefore(newItem, list.childNodes[0]);
                          document.getElementById(divElm).style.position='relative';
                        }
                      }
                      if(winningLen==0){
                        if(!document.getElementById('oiBottomAd')){
                            var noBidHtml = '<span class="close-ad" data-pid="oiBottomAd">X</span><div id="oiBottomAdHeading">No Winning Bids</div>';
                            var iDiv = document.createElement('div');
                            iDiv.id = 'oiBottomAd';
                            iDiv.innerHTML = noBidHtml;
                            iDiv.style.display='block';
                            document.getElementsByTagName('body')[0].appendChild(iDiv);
                            var bottomDiv = document.querySelector('.close-ad');
                            bottomDiv.onclick = function() { 
                                var cId = this.getAttribute('data-pid');
                                document.getElementById(cId).remove();
                            };
                          }
                      }
                    if (console.table) {
                      console.table(output);
                    } else {
                      for (var j = 0; j < output.length; j++) {
                        console.log(output[j]);
                      }
                    }
                  //}
                    
              } else {
                console.warn('NO prebid responses');
              }
            })();
        }
    };
})();
var enable_flag=1;
var disable_flag=0;
var loc_host=window.parent.location.hostname;
var oi_settings = {
                ad_config:{
                        'oneindia.com':
                            {'direct_ad':enable_flag},
                         'boldsky.com':
                            {'direct_ad':enable_flag}
                        ,
                        'filmibeat.com':
                            {'direct_ad':enable_flag}
                        ,
                        'drivespark.com':
                            {'direct_ad':enable_flag}
                        ,
                        'gizbot.com':
                            {'direct_ad':disable_flag}
                        ,
                        'goodreturns.in':
                            {'direct_ad':enable_flag}
                        ,
                        'careerindia.com':
                            {'direct_ad':enable_flag}
                        ,
                        'mykhel.com':
                            {'direct_ad':enable_flag}
                        ,
                        'nativeplanet.com':
                            {'direct_ad':enable_flag}
                        
                    }
      };
var json_config = JSON.parse(JSON.stringify(oi_settings.ad_config));
var direct_ad = localStorage.getItem("direct_ad");
if(direct_ad=="" || direct_ad=="undefined" || direct_ad==null){
      direct_ad = "";
}
  for (var key in json_config) {
    if (json_config.hasOwnProperty(key)) {
        if(loc_host.indexOf(key)>-1){
          var ad_flag = json_config[key].direct_ad;
          if(direct_ad =='' || direct_ad != ad_flag){
            localStorage.setItem("direct_ad",ad_flag);
          }
        }
    }
  }

/*Exit Screen with AD starts Here */
var exitScrolled=40;
var closeTabHtmlCss = '';
var closeTabCssWeb = "<style>.oi-site-popup-overlay{position: fixed;top: 0;right: 0;bottom: 0;left: 0;background: rgba(0,0,0,0.8);z-index: 1000000;}.oi-site-popup-wrap{width: 450px;height: 430px;background: #fff;border-radius: 15px;position: fixed;z-index: 10000000;left: 0;right: 0;top: 0;bottom: 0;margin: auto;box-shadow: 0 0 3px 3px #cdcdcd;font-family:arial;}.oi-site-popup-close{position: absolute;top: 20px;right: 20px;font-size: 20px;color: #666666;}.oi-site-popup-close a{color: #666;}.oi-site-popup-close img{width: 24px;height: 24px;}.oi-site-popup-header{padding: 20px 10px;margin: 20px 20px 0 20px;font-size: 18px;font-weight: normal;color: #000;text-transform: uppercase;text-align: center;}.oi-site-popup-text {font-size: 17px;color: #06c;text-align: center;border-bottom: 1px solid #f1f1f1;margin-bottom: 0px;padding-bottom: 10px;}.oi-site-popup-text a {color: #fff;background: #2a5e88;display: inline-block;padding: 5px 25px;border-radius: 5px;font-weight: bold;}.oi-site-popup-content{padding: 10px 0;text-align: center;}.oi-site-popup-footer{position: absolute;bottom: 0;left: 0;right: 0;}.oi-site-popup-footer:after{content: '';clear: both;display: table;}.oi-site-popup-footer ul li{list-style-type: none;float: left;width: 50%;}.oi-site-popup-footer a{display: block;padding: 20px 0;text-align: center;font-size: 18px;color: #6d6d6d;text-transform: uppercase;text-decoration: none;}.oi-site-popup-footer a.exit{color: #6d6d6d;}.oi-site-popup-footer a.back-home{color: #d56264;}@media only screen and (max-width: 728px){.oi-site-popup-wrap{width: 300px;height: 450px;}}@media only screen and (max-width: 320px){.oi-site-popup-wrap{width: 90%;height: 450px;}}.sitepopup-adv-block{background: #f5f5f5; padding-bottom: 10px; margin-bottom: 10px; min-height: 270px; width: 320px;margin: 0 auto;}.sitepopup-adv-heading{color: #333; font-size: 10px; padding: 7px 0 0; text-align: center; text-transform: uppercase;}</style>";
var closeTabHtmlWeb = '<div class="oi-site-popup-overlay" style="display:none;"></div><div class="oi-site-popup-wrap" style="display:none;"><div class="oi-site-popup-close"><a href="javascript:void(0);" class="close-pop"><img src="/images/close-btn.svg" alt="CLOSE" class="close-img" /></a></div><div class="oi-site-popup-header">Sure, You want to Exit?</div><div class="oi-site-popup-text"><a href="javascript:void(0);" class="back-home">Check out the latest updates</a></div><div class="oi-site-popup-content"><div class="oi-site-popup-ad"><div class="sitepopup-adv-block"><div class="sitepopup-adv-heading">Advertisement</div><div id="popup-ad" class="adElem"></div></div></div></div></div>';
if(window.location.search.indexOf('closetab=1')>-1){
  var scrollExecuteExit=0;
  var exitCss = "<style>.oi-site-popup-overlay{position:fixed;top:0;right:0;bottom:0;left:0;background:rgba(0,0,0,.8);z-index:10000}.oi-site-popup-wrap{width:1080px;height:400px;background:#fff;border-radius:15px;position:fixed;z-index:100000;left:0;right:0;top:0;bottom:0;margin:auto;box-shadow:0 0 3px 3px #cdcdcd}.oi-site-popup-close{position:absolute;top:10px;right:10px;font-size:20px;color:#666}.oi-site-popup-close a{color:#666}.oi-site-popup-close img{width:24px;height:24px}.oi-site-popup-header{font-family:arial;padding:0 10px 10px 10px;margin:20px 20px 20px 20px;font-size:18px;font-weight:400;color:#000;text-transform:uppercase;text-align:center;border-bottom:1px solid #f1f1f1}.oi-site-popup-text{font-size:17px;color:#06c;text-align:center;border-bottom:1px solid #f1f1f1;margin-bottom:15px;padding-bottom:10px}.oi-site-popup-text a{color:#fff;background:#2a5e88;display:inline-block;padding:5px 25px;border-radius:5px;font-weight:700}.oi-site-popup-footer{position:absolute;bottom:0;left:0;right:0}.oi-site-popup-footer:after{content:'';clear:both;display:table}.oi-site-popup-footer ul li{list-style-type:none;float:left;width:50%}.oi-site-popup-footer a{display:block;padding:20px 0;text-align:center;font-size:18px;color:#6d6d6d;text-transform:uppercase;text-decoration:none}.oi-site-popup-footer a.exit{color:#6d6d6d}.oi-site-popup-footer a.back-home{color:#d56264}.oi-site-popup-content{padding:10px 25px;text-align:center;position:relative}.oi-site-popup-content ul{padding:0;position:relative;white-space:nowrap;margin:0}.oi-site-popup-content ul li{list-style-type:none;display:inline-block;margin-right:15px;width:300px;vertical-align:top;white-space:normal}.oi-site-popup-content ul li:nth-child(3){width: 320px!important;}.oi-site-popup-content ul li a{text-decoration:none;display:block}.oi-site-popup-thumbimg img{display:block}.oi-site-popup-title{font-size:14px;color:#000;font-weight:600;padding:10px 0;text-align:left}.oi-site-popup-datetime{font-family:arial;font-size:12px;color:#666;text-align:left;font-weight:600}.oi-site-popup-content .bx-wrapper .bx-controls-direction a{position:absolute;top:100px;width:30px;height:30px;text-indent:-9999px}.oi-site-popup-content .bx-wrapper .bx-controls-direction a.bx-prev{left:0}.oi-site-popup-content .bx-wrapper .bx-controls-direction a.bx-next{right:0}.oi-site-popup-content .bx-wrapper .bx-controls-direction a::before{content:'';position:absolute;top:0;bottom:0;left:0;right:0;margin:auto;width:12px;height:12px;border-left:solid 2px #404040;border-bottom:solid 2px #404040}.oi-site-popup-content .bx-wrapper .bx-controls-direction a.bx-prev::before{-moz-transform:rotate(45deg);-ms-transform:rotate(45deg);-webkit-transform:rotate(45deg);transform:rotate(45deg)}.oi-site-popup-content .bx-wrapper .bx-controls-direction a.bx-next::before{-moz-transform:rotate(-135deg);-ms-transform:rotate(-135deg);-webkit-transform:rotate(-135deg);transform:rotate(-135deg)}@media only screen and (max-width:1000px){.oi-site-popup-wrap{width:95%;height:400px}}.sitepopup-adv-block{padding-bottom: 10px; min-height: 270px; width: 320px;margin: 0 auto;padding-right: 5px;}.sitepopup-adv-heading{font-family:arial;color: #333; font-size: 10px; padding: 7px 0 0; text-align: center; text-transform: uppercase;}}</style>";
  var exitHtml = '';
    function displayAd(){
                      var exit_frame=document.createElement("iframe");
                      exit_frame.src="https://rss.oneindia.com/common/common-exit-render.html";
                      exit_frame.scrolling="no";
                      exit_frame.width='310px';
                      exit_frame.height='260px';
                      exit_frame.style.border='0 none';
                      exit_frame.id='exitIframe';
                      document.getElementById('popup-ad').innerHTML='';
                      document.getElementById('popup-ad').appendChild(exit_frame);
                } 
    function close_window() {
			var urlParam = '?utm_medium=Desktop&utm_source='+urlUtm+'&utm_campaign=Exit-pop';
                    var redirectUrl = 'https://'+window.location.hostname;
                    window.location.href = redirectUrl+urlParam;
                }
                function closePop(){
                    if(document.querySelector('.oi-site-popup-overlay')){
                        document.querySelector('.oi-site-popup-overlay').style.display='none';
                        document.querySelector('.oi-site-popup-wrap').style.display='none';
                    }
                }
    function loadExtScript(){
            /*var exit_slider_script = document.createElement("script");
            exit_slider_script.src = "https://cdnjs.cloudflare.com/ajax/libs/bxslider/4.2.15/jquery.bxslider.min.js";
            exit_slider_script.onload = exit_slider_script.onreadystatechange = function() {
                //exit_slider_script.onreadystatechange = exit_slider_script.onload = null;
               getExitPopupData();
            }
            var head = document.getElementsByTagName("head")[0];
            (head || document.body).appendChild(exit_slider_script);*/
            getExitPopupData();
    }
    function checkAdViewPort(){
      var exitAdInViewPort = isVisible(document.getElementById('popup-ad'));
        exitAdInViewPort.then(vals => { 
            if(vals){
                if(document.getElementById('popup-ad').innerHTML==''){
                    displayAd();
                }
            }else{
              if(document.getElementById('popup-ad')){
                document.getElementById('popup-ad').innerHTML='';
              }
            }
          }); 
    }
    async function getExitPopupData(){
              var today = new Date();
              //var urlBurstParam = today.getDate();
              var urlBurstParam = new Date().getTime();//Math.floor(Math.random()*10000) + 1;//today.getHours();
              var apiUrl = "https://rss.oneindia.com/scripts/cms/getArticleDetails.php?type=latest-articles&sitename="+host+"&limit=4&output=json";
              let response = await fetch(apiUrl);
              let contentDetails = await response.json();
              var grplen = contentDetails.length;
              exitHtml+=exitCss;
              exitHtml+='<div class="oi-site-popup-overlay" style="visibility:hidden;"></div><div class="oi-site-popup-wrap" style="visibility:hidden;"><div class="oi-site-popup-close"><a href="javascript:void(0);" class="close-pop"><img src="/images/close-btn.svg" alt="CLOSE" class="close-img"/></a></div><div class="oi-site-popup-header">Check out the latest stories before Exit</div><div class="oi-site-popup-content"><ul>';
              var urlParam = '?utm_medium=Desktop&utm_source='+urlUtm+'&utm_campaign=Exit-pop';
              for(g=0;g<grplen;g++){
                  var artUrl = contentDetails[g].url+urlParam;
                  var artImg = contentDetails[g].image.replace("/img/", "/img/300x99/");;
                  var artHead = contentDetails[g].heading;
                  var artTime = contentDetails[g].published_ago;
                  exitHtml += '<li><a href="'+artUrl+'"><div class="oi-site-popup-thumbimg"><img src="'+artImg+'" alt=""/></div><div class="oi-site-popup-title">'+artHead+'</div><div class="oi-site-popup-datetime">'+artTime+'</div></a></li>';
                  if(g==1){
                    exitHtml +='<li style="width:320px!important;" class="adpopup"><div class="oi-site-popup-ad"><div class="sitepopup-adv-block"><div id="popup-ad" style="height:260px;"></div></div></div></li>';
                  }
              }
              exitHtml+='</ul></div>';
              var exitPopupDiv = document.createElement('div');
              exitPopupDiv.id = 'exitPopupDiv';
              exitPopupDiv.innerHTML = exitHtml;
              document.getElementsByTagName('body')[0].appendChild(exitPopupDiv);
              if(document.querySelector('.oi-site-popup-overlay')){
                  displayAd();
                  var windowsize = $(window).width();
                  if (windowsize < 640) {
                    var minslide = 1;
                    var maxslide = 1;
                  }else if(windowsize < 1000){
                    var minslide = 2;
                    var maxslide = 3;
                  }else{
                    var minslide = 3;
                    var maxslide = 4;
                  }
                  
                      $('.oi-site-popup-content ul').bxSlider({
                          minSlides: minslide,
                          maxSlides: maxslide,
                          moveSlides: 1,
                          slideMargin: 15,
                          slideWidth: 300,
                          adaptiveHeight: true,
                          pager: false,
                          infiniteLoop: false,
                          onSliderLoad:function(e){
                            console.log(e);
                            document.querySelector('.oi-site-popup-overlay').style.visibility='visible';
                            document.querySelector('.oi-site-popup-wrap').style.visibility='visible';
                          }
                      }); 
                  document.body.onclick = function (ev) {
                    var clickElem = ev.target.getAttribute("class");
                    if (clickElem == "close-pop" || clickElem == "close-img") {
                      closePop();
                    }
                    if (clickElem=="exit" || clickElem=="back-home") {
                        close_window();
                    }
                  };
              }
    }
    
    window.addEventListener("scroll", function(){
          amountscrolled();
          if(scrollExecuteExit==0){
             //console.log(pctScrolled + '% scrolled');
            if(pctScrolled >= exitScrolled){
              scrollExecuteExit=1;
              loadExtScript();
            }
          }
      }, false);
    }
function quizAd()
                {
                    var quiz_frame=document.createElement("iframe");
                    quiz_frame.src="https://rss.oneindia.com/common/common-oi-render.html";
                    quiz_frame.scrolling="no";
                    quiz_frame.width='310px';
                    quiz_frame.height='260px';
                    quiz_frame.style.border='0 none';
		    if(document.getElementById('quiz-ad')){
                    document.getElementById('quiz-ad').appendChild(quiz_frame);
		    }
                }

//if(window.location.search.indexOf('closetab=1')>-1){
if (document.getElementById("containerMain")) {
    var pageType = document.getElementById("containerMain").getAttribute("data-page_type");
    //if (pageType != 'homepage') {
  if(host.indexOf('oneindia')>'-1'){
  if (/Mobi|Android/i.test(navigator.userAgent)) {
	
  }else{
            //var googletag=googletag||{};googletag.cmd=googletag.cmd||[];
          var currentDateClose = new Date();
          var popupCounter = 0;
          var closetab_flag = getUserCookie('closetab_flag');
          var lastShownTs=+localStorage.getItem('article_popup_shown');
          console.log(lastShownTs);
          if(lastShownTs=="" || lastShownTs=="undefined" || lastShownTs==null){
            lastShownTs = "";
          }
          
          currentDate.setHours(0, 0, 0, 0);
          var lastShown = null;
          if (!isNaN(lastShownTs)) {
            lastShown = new Date(lastShownTs);
            lastShown.setHours(0, 0, 0, 0);
          }
          console.log("Closeeeeeeee");
                function displayAd(){
                      var exit_frame=document.createElement("iframe");
                      exit_frame.src="https://rss.oneindia.com/common/common-exit-render.html";
                      exit_frame.scrolling="no";
                      exit_frame.width='310px';
                      exit_frame.height='260px';
                      exit_frame.style.border='0 none';
			exit_frame.id='exitIframe';
			document.getElementById('popup-ad').innerHTML='';
                      document.getElementById('popup-ad').appendChild(exit_frame);
                }
                
                /*function quizAd()
                {
                    var quiz_frame=document.createElement("iframe");
                    quiz_frame.src="https://rss.oneindia.com/common/common-oi-render.html";
                    quiz_frame.scrolling="no";
                    quiz_frame.width='310px';
                    quiz_frame.height='260px';
                    quiz_frame.border='0 none';
                    document.getElementById('quiz-ad').appendChild(quiz_frame);
                }*/

                
                /*if(closetab_flag == 0){
                //if(popupCounter < 1) {
                   closeTabHtmlWeb+=closeTabCssWeb;
                   var closePopupDiv = document.createElement('div');
                    closePopupDiv.id = 'closePopupDiv';
                    closePopupDiv.innerHTML = closeTabHtmlWeb;
                    document.getElementsByTagName('body')[0].appendChild(closePopupDiv);
                   // setTimeout(function(){
                      //displayAd();
                    //},1000);
                }*/
               function addEvent(obj, evt, fn) {
                    if (obj.addEventListener) {
                        obj.addEventListener(evt, fn, false);
                    }
                    else if (obj.attachEvent) {
                        obj.attachEvent("on" + evt, fn);
                    }
                }
                function close_window() {
                    var urlParam = '?utm_medium=Desktop&utm_source='+urlUtm+'&utm_campaign=Exit-pop';
                    var redirectUrl = 'https://'+window.location.hostname;
                    window.location.href = redirectUrl+urlParam;
                }
                function closePop(){
                    if(document.querySelector('.oi-site-popup-overlay')){
                        document.querySelector('.oi-site-popup-overlay').style.display='none';
                        document.querySelector('.oi-site-popup-wrap').style.display='none';
                    }
                }
                addEvent(document, 'mouseout', function(evt) {
                  if (evt.toElement == null && evt.relatedTarget == null) {
                    var closetab_flag = getUserCookie('closetab_flag');
                    if(storedUrl=="" || storedUrl != promotedUrl){
                        closetab_flag = 1;
                    }else if(closetab_flag==null||closetab_flag==""){
                      closetab_flag = 0;
                    }
                    if(closetab_flag == 0){
                    //if (popupCounter < 1) {
			if(document.getElementById('closePopupDiv')){
                        document.getElementById('closePopupDiv').remove();
                      }
                        closeTabHtmlWeb+=closeTabCssWeb;
                       var closePopupDiv = document.createElement('div');
                        closePopupDiv.id = 'closePopupDiv';
                        closePopupDiv.innerHTML = closeTabHtmlWeb;
                        document.getElementsByTagName('body')[0].appendChild(closePopupDiv);
                        if(document.querySelector('.oi-site-popup-overlay')){
                            document.querySelector('.oi-site-popup-overlay').style.display='block';
                            document.querySelector('.oi-site-popup-wrap').style.display='block';
                            displayAd();
                            setUserCookie('closetab_flag',1,'','/','','');
                        }
                    }
                  }
                });
                document.body.onclick = function (ev) {
                    var clickElem = ev.target.getAttribute("class");
                    if (clickElem == "close-pop" || clickElem == "close-img") {
                      closePop();
                    }
                    if (clickElem=="exit" || clickElem=="back-home") {
                        close_window();
                    }
                  };
                }
            }
//}
}
var quizStatus=localStorage.getItem('quiz_attend_status');
if(quizStatus=="" || quizStatus=="undefined" || quizStatus==null){
  quizStatus = "";
}
if(quizStatus != ""){
  var jsonArr = JSON.parse(quizStatus);
  console.log(jsonArr);
  var gaEventVal = jsonArr.qevent;
  var triggerDevice = jsonArr.qdevice;
  var qslno = jsonArr.qtype;
  var cPath = window.location.pathname;
  var qpath = jsonArr.curPath;
  if(cPath != qpath){
    localStorage.removeItem('quiz_attend_status');
    eventTrackerRss(gaEventVal,'Quiz Article',triggerDevice,qslno);
  }
}
/*Exit Screen with AD Ends Here */
/* For You Banner For Home Page - Starts */
/*var bannerText = {"en": ["Follow topics of your interest to <br /> personalize Oneindia experience"], "hi": ["Follow topics of your interest to <br /> personalize Oneindia experience"],"te": ["వన్‌ ఇండియాలో మీకు గొప్ప అనుభూతి అందించే టాపిక్స్ కోసం ఫాలో అవ్వండి"],"ta":["ஒன்இந்தியாவில் உங்கள் விருப்ப பிரிவுகளை நீங்களே தேர்வு செய்து கொள்ளலாம்."],"kn":["ಒನ್‌ ಇಂಡಿಯಾ ಕನ್ನಡ'ದಲ್ಲಿ ನಿಮ್ಮ ಅಭಿರುಚಿಯ ಸುದ್ದಿಗಳನ್ನು ಓದಲು ಟಾಪಿಕ್‌ಗಳನ್ನು ಫಾಲೋ ಮಾಡಿ."],"ml":["Follow topics of your interest to <br /> personalize Oneindia experience"],"bn":["Follow topics of your interest to <br /> personalize Oneindia experience"],"gu":["Follow topics of your interest to <br /> personalize Oneindia experience"]};
var foryouBannerCss = "<style>.oi-foryou-banner-wrapper {background: #f6ead4;margin: 0 auto;height: 80px;} .oi-foryou-banner-wrapper a {display: block;text-decoration: none;} .oi-foryou-banner-wrapper:after {content: '';clear: both;display: table;} .oi-foryou-text {font-family:arial;font-size: 16px;color: #fff;font-weight: bold;padding: 0;position: relative;float: left;background: #383c3f;height: 80px;text-align: center;width: 100px;line-height: 80px;border-right: 5px solid #54575c;} .oi-foryou-text::before {content: '';position: absolute;top: 35px;left: 2px;margin-right: 15px;text-decoration: blink;-webkit-animation-name: blinker;-webkit-animation-duration: 1s;-webkit-animation-iteration-count: infinite;-webkit-animation-timing-function: ease-in-out;-webkit-animation-direction: alternate;background: #ff0000;height: 10px;width: 10px;border-radius: 50%;} .oi-foryou-desc {margin-left: 105px;border-left: 5px solid #ebcf9f;height: 80px;text-align: center;} .oi-foryou-desctext {padding: 5px;font-size: 14px;color: #000;display: inline-block;} .oi-foryou-btn {font-family:arial;background: #54575c;padding: 3px 15px;font-size: 14px;color: #fff;margin-top: 5px;} @media only screen and (max-width: 359px) { .oi-foryou-desctext, .oi-foryou-btn {font-size: 12px;} .oi-foryou-text {width: 110px;font-size: 16px;} .oi-foryou-desc {margin-left: 115px;} }</style>";
if(sitelang=='ta'){
  foryouBannerCss +="<style>.oi-foryou-desctext{font-size:12px!important;}.oi-foryou-banner-wrapper {height: 80px!important;}</style>";
}else if(sitelang=='kn'){
  foryouBannerCss +="<style>.oi-foryou-desctext{word-spacing: normal;}</style>";
}else if(sitelang=='ml'){
  foryouBannerCss +="<style>.oi-foryou-desctext{font-family:arial;line-height:19px;}.oi-foryou-btn {display:inherit;}</style>";
}
if(host!='' && host!=undefined){
    var domainParts = host.split('.');
    var langParam = langObj[domainParts[0]];
    var hostParam = hostObj[domainParts[1]];
    var urlUtm = hostParam+'-'+langParam;
}else{
    var urlUtm ='';
}
var finalUtmVal = '?utm_medium=Home&utm_source='+urlUtm+'&utm_campaign=For-You-Banner';
var foryouBannerHtml = foryouBannerCss+'<div class="oi-foryou-banner-wrapper"> <a href="/common/foryou/'+finalUtmVal+'"><div class="oi-foryou-text"> FOR YOU</div><div class="oi-foryou-desc"><div class="oi-foryou-desctext">'+bannerText[sitelang]+'<span class="oi-foryou-btn">Follow Now</span></div></div> </a></div>';
if(document.getElementById('foryou_banner')){
  document.getElementById('foryou_banner').innerHTML = foryouBannerHtml;
}*/
/* For You Banner For Home Page - Ends */
if(window.location.search.indexOf('pid=true')>-1){
      var finalArr = [];
      var mtype;
      if(typeof adUnits !== 'undefined'){
        for(var i=0;i<adUnits.length;i++){
                var tmpArr = [];
                tmpArr['Unit'] = adUnits[i]['code'];
                mtype = adUnits[i]['mediaTypes'];
                if(mtype.hasOwnProperty('banner')){
                    tmpArr['Size'] = JSON.stringify(mtype['banner']['sizes']);
                }else{
                    tmpArr['Size'] = JSON.stringify(mtype['video']['playerSize']);
                }
                var tmpBidArr = adUnits[i]['bids'];
                tmpArr['Bidder'] = {};
                var bidObj = {};
                for(var j=0;j<tmpBidArr.length;j++){
                    var temSid = {};
                    var bidderName = tmpBidArr[j]['bidder'];
                    if(!(bidObj.hasOwnProperty(bidderName))){
                        bidObj[bidderName] = [];
                    }
                    var sid, bidsize;
                    if(tmpBidArr[j]['params'].hasOwnProperty('siteId')){
                        sid = tmpBidArr[j]['params']['siteId'];
                    }else if(tmpBidArr[j]['params'].hasOwnProperty('pos')){
                        sid = tmpBidArr[j]['params']['pos'];
                    }else if(tmpBidArr[j]['params'].hasOwnProperty('publisherId')){
                        sid = tmpBidArr[j]['params']['publisherId'];
                    }else if(tmpBidArr[j]['params'].hasOwnProperty('unit')){
                        sid = tmpBidArr[j]['params']['unit'];
                    }else if(tmpBidArr[j]['params'].hasOwnProperty('placementId')){
                        sid = tmpBidArr[j]['params']['placementId'];
                    }else if(tmpBidArr[j]['params'].hasOwnProperty('pubId')){
                        sid = tmpBidArr[j]['params']['pubId'];
                    }
		     if(tmpBidArr[j]['params'].hasOwnProperty('size')){
                        bidsize = JSON.stringify(tmpBidArr[j]['params']['size']);
                    }else if(tmpBidArr[j]['params'].hasOwnProperty('zoneId')){
                        bidsize = tmpBidArr[j]['params']['zoneId'];
                    }else if(tmpBidArr[j]['params'].hasOwnProperty('adSlot')){
                        bidsize = tmpBidArr[j]['params']['adSlot'];
                    }else{
                        bidsize = 'NA';
                    }
                    temSid[sid] = bidsize;

                    bidObj[bidderName].push(JSON.stringify(temSid));
                    bidObj['totalbidder'] = j+1; 
                }
                tmpArr['Bidder']=bidObj;
                finalArr.push(tmpArr);
               
        }
         console.log("Plasement Ids for Cross Checking..");
         console.log(finalArr);
                
        //}
    }else{
        console.log("AD units Not found");
    }
}
