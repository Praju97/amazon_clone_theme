var channelHost;
(function() {
    var data_arr = '',
        final_data_arr = [],
        latest_data_arr = [],
        shortage_data_arr = [],
        tmpIds = [],
        tmpAllowedArr=[],
        allowedContentIds=[],
        createHtml = '',
        xmlhttp = new XMLHttpRequest(),
        obj = '',
        dynamicId = '',
        renderElem = '',
        homePageFlag=1,
        host, lang, sitelang, cssOutput, utmUrl,neededArticles,fetchArticleLang,totalPromoArticles;
    var langObj = {
        'www': 'EN',
        'bengali': 'BN',
        'gujarati': 'GU',
        'hindi': 'HI',
        'kannada': 'KN',
        'tamil': 'TA',
        'malayalam': 'ML',
        'telugu': 'TE'
    };
    var hostObj = {
        'oneindia': 'OI',
        'boldsky': 'BS',
        'gizbot': 'GZ',
        'drivespark': 'DS',
        'filmibeat': 'FB',
        'goodreturns': 'GR',
        'careerindia': 'CI',
        'mykhel': 'MK',
        'nativaplanet': 'NP',
        'indiansutras': 'IS'
    };
    var jsQuery = document.getElementById("nativeadjs").src.split("slotpos=")[1];
    jsQuery = jsQuery.split('&')[0];
    if (jsQuery == 'rightInclude') {
        renderElem = 2;
        lang = document.getElementById("nativeadjs").src.split("lang=")[1];
        sitelang = lang.split('&')[0];
        host = document.getElementById("nativeadjs").src.split("host=")[1];
        channelHost = host.split('&')[0];
        window.sitelang = sitelang;
        window.channelHost = channelHost;
        var curl = document.getElementById("nativeadjs").src.split("curl=")[1];
        curl = curl.split('&')[0];
        curl = curl.split('?')[0];
        var trackcode = document.getElementById("nativeadjs").src.split("trackcode=")[1];
        if (trackcode != undefined) {
            trackcode = trackcode.split('&')[0];
        } else {
            trackcode = 'RB';
        }
        console.log("trackcode:"+trackcode+" Lang:"+sitelang+" Channel Host:"+channelHost);
        xmlhttp.onreadystatechange = function() {
            if (this.readyState == 4 && this.status == 200) {
                data_arr = this.responseText;
                if (data_arr != '') {
                    final_data_arr = JSON.parse(data_arr)['article_right_promo'];
                    shortage_data_arr = JSON.parse(data_arr)['falling_short'];
                    if(final_data_arr == undefined){
                        /*var finallatestdata=[];
                        latest_data_arr = JSON.parse(data_arr)['latest'];
                        neededArticles = parseInt(renderElem);
                        if(neededArticles > 0){
                            latest_data_arr = getRandomElements(latest_data_arr, neededArticles);
                            for(var i = 0; i <= neededArticles-1; ++i) {
                                if(latest_data_arr[i].url != null && latest_data_arr[i].url != ''){
                                    latest_data_arr[i].url = createUrlUtm(latest_data_arr[i].url, i, 'NON-PROMOTIONAL', channelHost);
                                }
                                    finallatestdata.push(latest_data_arr[i]);
                             }
                        }
                        for (var m in finallatestdata) {
                            obj = finallatestdata[m];
                            if(obj.url != null && obj.url != ''){
                            if(obj.url.indexOf("?utm_medium=")=='-1'){
                                    utmUrl = createUrlUtm(obj.url, m,trackcode, channelHost);
                            }else{
                                utmUrl = obj.url;
                            }
                            }
                            var slno = parseInt(m) + 1;
                            tmpIds.push(obj.content_id);
                            utmUrl += "&utm_content=" + slno;
                            if(fetchArticleLang=='EN'){
                                createHtml += '<li><a href="' + utmUrl + '" rel="nofollow" target="_blank"><div class="sixtysec-left"><img alt="' + obj.heading + '" src="' + obj.mobi_image + '" ></div><div class="sixtysec-right" style="font-family:arial;font-size:15px;">' + obj.heading + '</div><div class="clear"></div></a></li>';
                            }else{
                                createHtml += '<li><a href="' + utmUrl + '" rel="nofollow" target="_blank"><div class="sixtysec-left"><img alt="' + obj.heading + '" src="' + obj.mobi_image + '" ></div><div class="sixtysec-right">' + obj.heading + '</div><div class="clear"></div></a></li>';
                            }
                            
                        }*/
                        createHtml +='';
                    }else{
                        latest_data_arr = JSON.parse(data_arr)['latest'];
                        
                        for (var i = final_data_arr.length - 1; i >= 0; --i) {
                            var allowed_website = final_data_arr[i].allowed_website;
                            if (allowed_website.indexOf(channelHost) > '-1' || allowed_website=='all') {
                                tmpAllowedArr.push(final_data_arr[i]);
                                allowedContentIds.push(final_data_arr[i].content_id);
                            }
                        }
                        totalPromoArticles = tmpAllowedArr.length;
                        if(totalPromoArticles > 2){
                            localStorage.setItem("allowed_ids",JSON.stringify(allowedContentIds));
                            for (var i = tmpAllowedArr.length - 1; i >= 0; --i) {
                                var counterVal = localStorage.getItem(tmpAllowedArr[i].content_id);
                                var fgap = tmpAllowedArr[i].frequency_cap;
                                if (counterVal==fgap) {
                                    //localStorage.removeItem(tmpAllowedArr[i].content_id);
                                    storeIdsLocalAfterQuota(tmpAllowedArr[i].content_id,fgap,totalPromoArticles);
                                    tmpAllowedArr.splice(i, 1);
                                }
                            }
                        }
                        final_data_arr=tmpAllowedArr;
                        console.log(final_data_arr);
                        for (var i = final_data_arr.length - 1; i >= 0; --i) {
                            if(final_data_arr[i].url == curl) {
                                final_data_arr.splice(i, 1);
                            }
                        }
                         neededArticles = parseInt(renderElem) - parseInt(final_data_arr.length);
                        /*if(neededArticles > 0){
                            latest_data_arr = getRandomElements(latest_data_arr, neededArticles);
                            for(var i = 0; i <= neededArticles-1; ++i) {
                                if(latest_data_arr[i].url != null && latest_data_arr[i].url != ''){
                                    latest_data_arr[i].url = createUrlUtm(latest_data_arr[i].url, i, 'NON-PROMOTIONAL', channelHost);
                                }
                                    final_data_arr.push(latest_data_arr[i]);
                             }
                        }*/
                        if (final_data_arr.length < renderElem) {
                            renderElem = final_data_arr.length;
                        } else {
                            renderElem = renderElem;
                        }
                        final_data_arr = getRandomElements(final_data_arr, renderElem);
                        for (var m in final_data_arr) {
                            obj = final_data_arr[m];
                            if(obj.url != null && obj.url != ''){
                                if(obj.url.indexOf("?utm_medium=")=='-1'){
                                        utmUrl = createUrlUtm(obj.url, m,trackcode, channelHost);
                                }else{
                                    utmUrl = obj.url;
                                }
                            }
                            var slno = parseInt(m) + 1;
                            tmpIds.push(obj.content_id);
                            utmUrl += "&utm_content=" + slno;
                            if(fetchArticleLang=='EN'){
                                createHtml += '<li><a href="' + utmUrl + '" rel="nofollow" target="_blank"><div class="sixtysec-left"><img alt="' + obj.heading + '" src="' + obj.mobi_image + '" ></div><div class="sixtysec-right" style="font-family:arial;font-size:15px;">' + obj.heading + '</div><div class="clear"></div></a></li>';
                            }else{
                                createHtml += '<li><a href="' + utmUrl + '" rel="nofollow" target="_blank"><div class="sixtysec-left"><img alt="' + obj.heading + '" src="' + obj.mobi_image + '" ></div><div class="sixtysec-right">' + obj.heading + '</div><div class="clear"></div></a></li>';
                            }
			    if(totalPromoArticles > 2){
                            checkFrequencyGap(obj.content_id,obj.frequency_cap);
                        }
                            
                        }
                    }
                    
                    
                    if (document.getElementById("right-native-ad")) {
                        document.getElementById("right-native-ad").innerHTML = createHtml;
                    }
                    
                    //if(shortage_data_arr != undefined){
                        fallingShortage(tmpIds,shortage_data_arr,channelHost);
                        if(totalPromoArticles > 2){
                            removeItemFromLocal(totalPromoArticles,"allowed_ids");
                        }
                }
            }
        };
        xmlhttp.open("GET", "https://rss.oneindia.com/common/"+sitelang+"-advertorial.json", true);
        xmlhttp.send();
    } else if (jsQuery == 'homeInclude') {
        renderElem = document.getElementById("nativeadjs").src.split("renderElem=")[1];
        /*if(renderElem==undefined){
            renderElem=1;
        }else{
            renderElem = renderElem.split('&')[0];
        }*/
        renderElem=2;
        console.log(renderElem);
        lang = document.getElementById("nativeadjs").src.split("lang=")[1];
        sitelang = lang.split('&')[0];
        host = document.getElementById("nativeadjs").src.split("host=")[1];
        channelHost = host.split('&')[0];
        curl = document.getElementById("nativeadjs").src.split("curl=")[1];
        curl = curl.split('&')[0];
        var trackcode = document.getElementById("nativeadjs").src.split("trackcode=")[1];
        if (trackcode != undefined) {
            trackcode = trackcode.split('&')[0];
        } else {
            trackcode = 'HP';
        }
        if(homePageFlag==1){
                    xmlhttp.onreadystatechange = function() {
                    if (this.readyState == 4 && this.status == 200) {
                        var tmpAllowedArrHome = [];
                        data_arr = this.responseText;
                        if (data_arr != '') {
                            final_data_arr = JSON.parse(data_arr)['article_right_promo'];
                            if(final_data_arr == undefined){
                                final_data_arr = '';//JSON.parse(data_arr)['latest'];
                                neededArticles = 0;//parseInt(renderElem);
                            }else{
                                neededArticles = parseInt(renderElem) - parseInt(final_data_arr.length);
                                
                                for (var i = final_data_arr.length - 1; i >= 0; --i) {
                                    var allowed_website = final_data_arr[i].allowed_website;
                                    if (allowed_website.indexOf(channelHost) > '-1' || allowed_website=='all') {
                                        tmpAllowedArrHome.push(final_data_arr[i]);
                                        allowedContentIds.push(final_data_arr[i].content_id);
                                    }
                                }
                            }
                            final_data_arr=tmpAllowedArrHome;
                            console.log(final_data_arr);
                            if(final_data_arr!=undefined){
                            	if (final_data_arr.length < renderElem) {
	                                renderElem = final_data_arr.length;
	                            } else {
	                                renderElem = renderElem;
	                            }
                                final_data_arr = getRandomElements(final_data_arr, renderElem);
                                var els = document.getElementsByClassName("oiNativePromo");
                                var elemLen = els.length;
                                var iterateLen = final_data_arr.length;
                                console.log(final_data_arr);
                                for (var m in final_data_arr) {
                                    obj = final_data_arr[m];
                                    if(obj.url.indexOf("?utm_medium=")=='-1'){
                                        utmUrl = createUrlUtm(obj.url, m,trackcode, channelHost);
                                    }else{
                                        utmUrl = obj.url;
                                    }
                                    var slno = parseInt(m) + 1;
                                    utmUrl += "&utm_content=" + slno;
                                    for (var i = 0; i < iterateLen; i++) {
                                    if(fetchArticleLang=='EN'){
                                       createHtml = '<a href="' + utmUrl + '" target="_blank"><div class="news-thumbimg"> <img alt="" class="homeSmallImage" src="' + obj.mobi_image + '"> </div><div class="news-desc" style="font-family:arial;font-size:15px;">' + obj.heading + '</div></a>'; 
                                    }else{
                                        createHtml = '<a href="' + utmUrl + '" target="_blank"><div class="news-thumbimg"> <img alt="" class="homeSmallImage" src="' + obj.mobi_image + '"> </div><div class="news-desc">' + obj.heading + '</div></a>';
                                    }
                                        if (document.getElementById("oiNativePromo"+slno)) {
                                            document.getElementById("oiNativePromo"+slno).innerHTML = createHtml;
                                        }
                                    }
                                    
                                }
                            }
                        }
                    }
                };
        }else{
                xmlhttp.onreadystatechange = function() {
                    if (this.readyState == 4 && this.status == 200) {
                        data_arr = this.responseText;
                        var tmpAllowedArrHome = [];
                        var allowedContentIds = [];
                        if (data_arr != '') {
                            final_data_arr = JSON.parse(data_arr)['article_right_promo'];
                            if(final_data_arr == undefined){
                                final_data_arr = '';//JSON.parse(data_arr)['latest'];
                                neededArticles = 0;//parseInt(renderElem);
                            }else{
                                neededArticles = parseInt(renderElem) - parseInt(final_data_arr.length);
                                console.log(final_data_arr);
                                for (var i = final_data_arr.length - 1; i >= 0; --i) {
                                    var allowed_website = final_data_arr[i].allowed_website;
                                    if (allowed_website.indexOf(channelHost) > '-1' || allowed_website=='all') {
                                        tmpAllowedArrHome.push(final_data_arr[i]);
                                        allowedContentIds.push(final_data_arr[i].content_id);
                                    }
                                }
                            }
                            var frequencyQuota = localStorage.getItem('allowed_ids');
                            if(frequencyQuota=='' || frequencyQuota == 'undefined' || frequencyQuota == null){
                                localStorage.setItem("allowed_ids",JSON.stringify(allowedContentIds));
                            }
                            var totalPromoArticlesHome = tmpAllowedArrHome.length;
                                if(totalPromoArticlesHome > 2){
                                    for (var i = tmpAllowedArrHome.length - 1; i >= 0; --i) {
                                        var counterVal = localStorage.getItem(tmpAllowedArrHome[i].content_id);
                                        var fgap = tmpAllowedArrHome[i].frequency_cap;
                                        if (counterVal==fgap) {
                                            //localStorage.removeItem(tmpAllowedArr[i].content_id);
                                            storeIdsLocalAfterQuota(tmpAllowedArrHome[i].content_id,fgap,totalPromoArticlesHome);
                                            tmpAllowedArrHome.splice(i, 1);
                                        }
                                    }
                                }
                            final_data_arr=tmpAllowedArrHome;
                            latest_data_arr = JSON.parse(data_arr)['latest'];
                            console.log(neededArticles);
                            /*if(neededArticles > 0){
                                latest_data_arr = getRandomElements(latest_data_arr, neededArticles);
                                for(var i = 0; i <= neededArticles-1; ++i) {
                                    if(latest_data_arr[i].url != null && latest_data_arr[i].url != ''){
                                        latest_data_arr[i].url = createUrlUtm(latest_data_arr[i].url, i, 'NON-PROMOTIONAL', channelHost);
                                    }
                                        final_data_arr.push(latest_data_arr[i]);
                                 }
                            }*/
                            if (final_data_arr.length < renderElem) {
                                renderElem = final_data_arr.length;
                            } else {
                                renderElem = renderElem;
                            }
                            final_data_arr = getRandomElements(final_data_arr, renderElem);
                            for (var m in final_data_arr) {
                                obj = final_data_arr[m];
                                if(obj.url != null && obj.url != ''){
                                    if(obj.url.indexOf("?utm_medium=")=='-1'){
                                            utmUrl = createUrlUtm(obj.url, m,trackcode, channelHost);
                                    }else{
                                        utmUrl = obj.url;
                                    }
                                }
                                var slno = parseInt(m) + 1;
                                utmUrl += "&utm_content=" + slno;
                                if(fetchArticleLang=='EN'){
                                   createHtml += '<a href="' + utmUrl + '" target="_blank"><div class="news-thumbimg"> <img alt="" class="homeSmallImage" src="' + obj.mobi_image + '"> </div><div class="news-desc" style="font-family:arial;font-size:15px;">' + obj.heading + '</div></a>'; 
                                }else{
                                    createHtml += '<a href="' + utmUrl + '" target="_blank"><div class="news-thumbimg"> <img alt="" class="homeSmallImage" src="' + obj.mobi_image + '"> </div><div class="news-desc">' + obj.heading + '</div></a>';
                                }
                                if(totalPromoArticlesHome > 2){
                                    checkFrequencyGap(obj.content_id,obj.frequency_cap);
                                }
                            }
                            if (document.getElementById("oiNativePromo1")) {
                                document.getElementById("oiNativePromo1").innerHTML = createHtml;
                            }
                            if(totalPromoArticlesHome > 2){
                                removeItemFromLocal(totalPromoArticlesHome,"allowed_ids");
                            }
                        }
                    }
                };
        }
        xmlhttp.open("GET", "https://rss.oneindia.com/common/"+sitelang+"-advertorial.json", true);
        xmlhttp.send();
    } else if (jsQuery == 'indexInclude') {
        renderElem = 1;
        lang = document.getElementById("nativeadjs").src.split("lang=")[1];
        sitelang = lang.split('&')[0];
        host = document.getElementById("nativeadjs").src.split("host=")[1];
        channelHost = host.split('&')[0];
        var trackcode = document.getElementById("nativeadjs").src.split("trackcode=")[1];
        if (trackcode != undefined) {
            trackcode = trackcode.split('&')[0];
        } else {
            trackcode = 'IP';
        }
        xmlhttp.onreadystatechange = function() {
            if (this.readyState == 4 && this.status == 200) {
                data_arr = this.responseText;
                 var tmpAllowedArrIndex = [];
                var allowedContentIds = [];
                if (data_arr != '') {
                    final_data_arr = JSON.parse(data_arr)['article_right_promo'];
                    if(final_data_arr == undefined){
                        final_data_arr = '';//JSON.parse(data_arr)['latest'];
                        neededArticles = 0;//parseInt(renderElem);
                    }else{
                        neededArticles = parseInt(renderElem) - parseInt(final_data_arr.length);
                        for (var i = final_data_arr.length - 1; i >= 0; --i) {
                            var allowed_website = final_data_arr[i].allowed_website;
                            if (allowed_website.indexOf(channelHost) > '-1' || allowed_website=='all') {
                                tmpAllowedArrIndex.push(final_data_arr[i]);
                                allowedContentIds.push(final_data_arr[i].content_id);
                            }
                        }
                    }
                    var frequencyQuota = localStorage.getItem('allowed_ids');
                    if(frequencyQuota=='' || frequencyQuota == 'undefined' || frequencyQuota == null){
                        localStorage.setItem("allowed_ids",JSON.stringify(allowedContentIds));
                    }
                    var totalPromoArticlesIndex = tmpAllowedArrIndex.length;
                        if(totalPromoArticlesIndex > 2){
                            for (var i = tmpAllowedArrIndex.length - 1; i >= 0; --i) {
                                var counterVal = localStorage.getItem(tmpAllowedArrIndex[i].content_id);
                                var fgap = tmpAllowedArrIndex[i].frequency_cap;
                                if (counterVal==fgap) {
                                    //localStorage.removeItem(tmpAllowedArr[i].content_id);
                                    storeIdsLocalAfterQuota(tmpAllowedArrIndex[i].content_id,fgap,totalPromoArticlesIndex);
                                    tmpAllowedArrIndex.splice(i, 1);
                                }
                            }
                        }
                    final_data_arr=tmpAllowedArrIndex;
                    latest_data_arr = JSON.parse(data_arr)['latest'];
                    
                    console.log(neededArticles);
                    /*if(neededArticles > 0){
                        latest_data_arr = getRandomElements(latest_data_arr, neededArticles);
                        for(var i = 0; i <= neededArticles-1; ++i) {
                            if(latest_data_arr[i].url != null && latest_data_arr[i].url != ''){
                                latest_data_arr[i].url = createUrlUtm(latest_data_arr[i].url, i, 'NON-PROMOTIONAL', channelHost);
                            }
                                final_data_arr.push(latest_data_arr[i]);
                         }
                    }*/
                    if (final_data_arr.length < renderElem) {
                        renderElem = final_data_arr.length;
                    } else {
                        renderElem = renderElem;
                    }
                    final_data_arr = getRandomElements(final_data_arr, renderElem);
                    for (var m in final_data_arr) {
                        obj = final_data_arr[m];
                         if(obj.url != null && obj.url != ''){
                            if(obj.url.indexOf("?utm_medium=")=='-1'){
                                    utmUrl = createUrlUtm(obj.url, m,trackcode, channelHost);
                            }else{
                                utmUrl = obj.url;
                            }
                        }
                        var slno = parseInt(m) + 1;
                        utmUrl += "&utm_content=" + slno;
                        if(fetchArticleLang=='EN'){
                            createHtml += '<a href="' + utmUrl + '" target="_blank"><div class="news-thumbimg"> <img alt="" class="homeSmallImage" src="' + obj.mobi_image + '"> </div><div class="news-desc" style="font-family:arial;font-size:15px;">' + obj.heading + '</div></a>';
                        }else{
                           createHtml += '<a href="' + utmUrl + '" target="_blank"><div class="news-thumbimg"> <img alt="" class="homeSmallImage" src="' + obj.mobi_image + '"> </div><div class="news-desc">' + obj.heading + '</div></a>'; 
                        }
                        if(totalPromoArticlesIndex > 2){
                            checkFrequencyGap(obj.content_id,obj.frequency_cap);
                        }
                    }
                    if (document.getElementById("oiNativePromo1")) {
                        document.getElementById("oiNativePromo1").innerHTML = createHtml;
                    }
                    if(totalPromoArticlesIndex > 2){
                        removeItemFromLocal(totalPromoArticlesIndex,"allowed_ids");
                    }
                }
            }
        };
        xmlhttp.open("GET", "https://rss.oneindia.com/common/"+sitelang+"-advertorial.json", true);
        xmlhttp.send();
    }
    var fallingShortage = function(tmpIds,shortage_data_arr,channelHost){
    		console.log(tmpIds);
            var createHtmlShort='';
            var renderElem_short=2;
            if(shortage_data_arr==undefined){
            	/*var shortage_data_arr_final=[];
            	var final_output=[];
                latest_data_arr = JSON.parse(data_arr)['latest'];
                    neededArticles = parseInt(renderElem_short);
                    var totalNo = parseInt(latest_data_arr.length)-1;
                    var prevRecNo = parseInt(tmpIds.length);
                    for (var i=totalNo; i>=0; i--) {
                        for( var j=0; j<prevRecNo; j++){
                            if (latest_data_arr[i] && (latest_data_arr[i].content_id == tmpIds[j])) {
                                latest_data_arr.splice(i, 1);
                            }
                        }
                    }
                    shortage_data_arr_final = getRandomElements(latest_data_arr, neededArticles);
                    console.log(shortage_data_arr_final);
                    if(neededArticles > 0){
                        for(var i = 0; i <= neededArticles-1; ++i) {
                                if(shortage_data_arr_final[i].url != null && shortage_data_arr_final[i].url != ''){
                                     shortage_data_arr_final[i].url = createUrlUtm(shortage_data_arr_final[i].url, i, 'NON-PROMOTIONAL', channelHost);
                                }
                                final_output.push(shortage_data_arr_final[i]);
                         }
                    }
                   if(final_output.length > 0){
		                for (var m in final_output) {
		                    var objshort = final_output[m];
                            if(objshort.url != null && objshort.url != ''){
		                      utmUrl = createUrlUtm(objshort.url, m, 'LB', channelHost);
                            }
                            if(fetchArticleLang=='EN'){
                                createHtmlShort += '<li><a href="' + utmUrl + '" rel="nofollow" target="_blank"><div class="sixtysec-left"><img alt="' + objshort.heading + '" src="' + objshort.mobi_image + '" ></div><div class="sixtysec-right" style="font-family:arial;font-size:15px;">' + objshort.heading + '</div><div class="clear"></div></a></li>';
                            }else{
                                createHtmlShort += '<li><a href="' + utmUrl + '" rel="nofollow" target="_blank"><div class="sixtysec-left"><img alt="' + objshort.heading + '" src="' + objshort.mobi_image + '" ></div><div class="sixtysec-right">' + objshort.heading + '</div><div class="clear"></div></a></li>';
                            }
		                    
		                }
            		}*/
                    createHtmlShort +='';
            }else{
                var totalNo = parseInt(shortage_data_arr.length)-1;
                var prevRecNo = parseInt(tmpIds.length);
                var tmpShortageArr = [];
                var allowedShortageIds = [];
                for (var i = shortage_data_arr.length - 1; i >= 0; --i) {
                    var allowed_website = shortage_data_arr[i].allowed_website;
                    if (allowed_website.indexOf(channelHost) > '-1' || allowed_website=='all') {
                        tmpShortageArr.push(shortage_data_arr[i]);
                        allowedShortageIds.push(shortage_data_arr[i].content_id);
                    }
                }
                
                var totalPromoArticlesShort = tmpShortageArr.length;
                if(totalPromoArticlesShort > 2){
                    localStorage.setItem("allowed_short_ids",JSON.stringify(allowedShortageIds));
                    for (var i = tmpShortageArr.length - 1; i >= 0; --i) {
                        var counterVal = localStorage.getItem(tmpShortageArr[i].content_id);
                        var fgap = tmpShortageArr[i].frequency_cap;
                        if (counterVal==fgap) {
                            //localStorage.removeItem(tmpAllowedArr[i].content_id);
                            storeIdsLocalAfterQuota(tmpShortageArr[i].content_id,fgap,totalPromoArticlesShort);
                            tmpShortageArr.splice(i, 1);
                        }
                    }
                }
                shortage_data_arr=tmpShortageArr;
                for (var i=totalNo; i>=0; i--) {
                    for( var j=0; j<prevRecNo; j++){
                        if (shortage_data_arr[i] && (shortage_data_arr[i].content_id == tmpIds[j])) {
                            shortage_data_arr.splice(i, 1);
                        }
                    }
                }
                
                for (var k = shortage_data_arr.length - 1; k >= 0; --k) {
                    if (shortage_data_arr[k].url == curl) {
                        shortage_data_arr.splice(k, 1);
                    }
                }
                latest_data_arr = JSON.parse(data_arr)['latest'];
                neededArticles = parseInt(renderElem_short) - parseInt(shortage_data_arr.length);
                console.log(neededArticles);
                /*if(neededArticles > 0){
                    latest_data_arr = getRandomElements(latest_data_arr, neededArticles);
                    for(var i = 0; i <= neededArticles-1; ++i) {
                            if(latest_data_arr[i].url != null && latest_data_arr[i].url != ''){
                                latest_data_arr[i].url = createUrlUtm(latest_data_arr[i].url, i, 'NON-PROMOTIONAL', channelHost);
                            }
                            shortage_data_arr.push(latest_data_arr[i]);
                     }
                }*/
                var totalNolatest = parseInt(shortage_data_arr.length)-1;
                    var prevRecNolatest = parseInt(tmpIds.length);
                    for (var i=totalNolatest; i>=0; i--) {
                        for( var j=0; j<prevRecNolatest; j++){
                            if (shortage_data_arr[i] && (shortage_data_arr[i].content_id == tmpIds[j])) {
                                shortage_data_arr.splice(i, 1);
                            }
                        }
                    }
                if (shortage_data_arr.length < renderElem_short) {
                    renderElem_short = shortage_data_arr.length;
                } else {
                    renderElem_short = renderElem_short;
                }
                shortage_data_arr = getRandomElements(shortage_data_arr, renderElem_short);
                if(shortage_data_arr.length > 0){
	                for (var m in shortage_data_arr) {
	                    var objshort = shortage_data_arr[m];
                        if(objshort.url != null && objshort.url != ''){
	                       utmUrl = createUrlUtm(objshort.url, m, 'LB', channelHost);
                        }
                        if(fetchArticleLang=='EN'){
                            createHtmlShort += '<li><a href="' + utmUrl + '" rel="nofollow" target="_blank"><div class="sixtysec-left"><img alt="' + objshort.heading + '" src="' + objshort.mobi_image + '" ></div><div class="sixtysec-right" style="font-family:arial;font-size:15px;">' + objshort.heading + '</div><div class="clear"></div></a></li>';
                        }else{
                           createHtmlShort += '<li><a href="' + utmUrl + '" rel="nofollow" target="_blank"><div class="sixtysec-left"><img alt="' + objshort.heading + '" src="' + objshort.mobi_image + '" ></div><div class="sixtysec-right">' + objshort.heading + '</div><div class="clear"></div></a></li>'; 
                        }
	                    if(totalPromoArticlesShort > 2){
                            checkFrequencyGap(objshort.content_id,objshort.frequency_cap);
                        }
	                }
            	}
            }
            
            
            if (document.getElementById("left-native-ad")) {
	            document.getElementById("left-native-ad").innerHTML = createHtmlShort;
	        }
	        
	        
            if(totalPromoArticlesShort > 2){
                removeItemFromLocal(totalPromoArticlesShort,"allowed_short_ids");
            }
    };
    var getRandomElements = function(sourceArray, neededElements) {
        var result = [];
        for (var i = 0; i < neededElements; i++) {
            var random = Math.floor(Math.random() * sourceArray.length);
            result.push(sourceArray[random]);
            sourceArray.splice(random, 1);
        }
        return result;
    };
    var createUrlUtm = function(url, index, utmmedium, channelHost) {
        var newUrl = '';
        var domain_name = GetDomainName(url);
        var domainParts = domain_name.split('.');
        var lang = langObj[domainParts[0]];
        fetchArticleLang = langObj[domainParts[0]];
        var slno = parseInt(index) + 1;
        if(url.indexOf('bit.ly')>'-1'){
        	channelHost='BITLY';
        	lang='EN';
        }
        var utm = "?utm_medium=" + utmmedium + "&utm_source=" + channelHost + "-" + lang + "&utm_campaign=nativeAd";
        newUrl = url + utm;
        return newUrl;
    };
    var GetDomainName = function(url) {
        var url_parts = url.split('/');
        var domain_name_parts = url_parts[2].split(':');
        var domain_name = domain_name_parts[0];
        return domain_name;
    };
    var checkFrequencyGap = function(cid,fgap){
            var counterVal = localStorage.getItem(cid);
            if(counterVal=='' || counterVal == 'undefined' || counterVal == null){
                counterVal = 0;
            }else{
                counterVal = parseInt(counterVal);
            }
            if(counterVal!=fgap){
                counterVal++;
                localStorage.setItem(cid,counterVal);
            }
    };
    var storeIdsLocalAfterQuota = function(cid,fgap,totalLen){
            var counterVal = localStorage.getItem(cid);
            if(counterVal=='' || counterVal == 'undefined' || counterVal == null){
                counterVal = 0;
            }else{
                counterVal = parseInt(counterVal);
            }
            var frequencyFilled = [];
            var frequencyQuota = localStorage.getItem('frequency_quota');
            var removeStorageFreq = parseInt(frequencyFilled.length);
            var totalSrorageFreq = parseInt(fgap)-2;
            if(frequencyQuota=='' || frequencyQuota == 'undefined' || frequencyQuota == null){
                var fq = '';
            }
            if(counterVal==fgap){
                    if(fq == ''){
                        frequencyFilled.push(cid);
                        localStorage.setItem("frequency_quota",JSON.stringify(frequencyFilled));
                    }else{
                        frequencyFilled = JSON.parse(frequencyQuota);
                        if(frequencyFilled.indexOf(cid)=='-1'){
                            frequencyFilled.push(cid);
                            localStorage.setItem("frequency_quota",JSON.stringify(frequencyFilled));
                        }
                    }
            }
    };
    var removeItemFromLocal = function(totalLen,storageKey){
        var removeItem = parseInt(totalLen)-2;
        var frequencyQuota = localStorage.getItem('frequency_quota');
        var allowedIds = localStorage.getItem('allowed_ids');
        if(frequencyQuota=='' || frequencyQuota == 'undefined' || frequencyQuota == null){
                var fq = '';
            }
            if(fq != ''){
                var fQuota = JSON.parse(frequencyQuota);
                var allowed_ids = JSON.parse(allowedIds);
                var flen = fQuota.length;
                if(flen >= removeItem){
                    localStorage.removeItem('frequency_quota');
                    for (var i = 0; i < allowed_ids.length; i++) {
                        localStorage.removeItem(allowed_ids[i]);
                    }
                    localStorage.removeItem(storageKey);
                }
            }
    };
})();
/*Swipe Popup Code - Starts*/
var fetchdomainName = document.getElementById("nativeadjs").src.split("curl=")[1];
var domainName = fetchdomainName.split('&')[0];
var socialdomain = domainName.replace('http://','').replace('https://','').split(/[/?#]/)[0];
var socialreferrer = document.referrer;
if (socialreferrer == '' || socialreferrer == undefined || socialreferrer == null) {
    var socialreferrer = fetchdomainName;
    var socialdomain = socialreferrer.replace('http://', '').replace('https://', '').split(/[/?#]/)[0];
    var domainMid = socialdomain.split('.')[1];
} else {
    var socialdomain = socialreferrer.replace('http://', '').replace('https://', '').split(/[/?#]/)[0];
    var domainMid = socialdomain.split('.')[1];
}
var domainArr=['oneindia','boldsky','filmibeat','gizbot','drivespark','mykhel','goodreturns','careerindia','nativeplanet','indiansutras'];
if (domainArr.indexOf(domainMid) > '-1') {
    var socialFlag = 1;
} else {
    var socialFlag = 0;
}
console.log(socialFlag + ' : Social Flag');
function checkUserCookie(cookie_name) {
    var location_details = getUserCookie(cookie_name);
    if (location_details == null || location_details == "") {
        return false;
    } else if (location_details != "") {
        return true;
    }
}
function getUserCookie(c_name) {
    var c_value = document.cookie;
    var c_start = c_value.indexOf(" " + c_name + "=");
    if (c_start == -1) {
        c_start = c_value.indexOf(c_name + "=");
    }
    if (c_start == -1) {
        c_value = null;
    } else {
        c_start = c_value.indexOf("=", c_start) + 1;
        var c_end = c_value.indexOf(";", c_start);
        if (c_end == -1) {
            c_end = c_value.length;
        }
        c_value = unescape(c_value.substring(c_start, c_end));
    }
    return c_value;
}
function displaySwipePopup(socialFlag){
    console.log(socialFlag + ' : Social Flag');
    if (socialFlag == 0) {
        var is_swipe_seen = getUserCookie('swipeShown');
        console.log(is_swipe_seen + ' : is_swipe_seen');
        setTimeout(function() {
            if (typeof(is_swipe_seen) == "undefined" || is_swipe_seen == null) {
                if (document.getElementById("swipe-block")) {
                    var elementClass = document.getElementById("swipe-block").classList;
                    if (!elementClass.contains('active')) {
                        elementClass.add("active");
                        document.querySelector('html,body').style.overflow = 'hidden';
                    }
                    setTimeout(function() {
                        if (elementClass.contains('active')) {
                            elementClass.remove("active");
                            document.querySelector('html,body').style.overflow = 'auto';
                        }
                    }, 5000);

                }
            }
            console.log("window.onload");
        }, 3000);
        if (document.getElementById("swipe-block")) {
            document.getElementById("swipe-block").onclick = function() {
                var elementClass = document.getElementById("swipe-block").classList;
                if (elementClass.contains('active')) {
                    elementClass.remove("active");
                    document.querySelector('html,body').style.overflow = 'auto';
                }
            };
        }
    }
}
function detectmob() { 
 if( navigator.userAgent.match(/Android/i) || navigator.userAgent.match(/webOS/i) || navigator.userAgent.match(/iPhone/i) || navigator.userAgent.match(/iPad/i) || navigator.userAgent.match(/iPod/i) || navigator.userAgent.match(/BlackBerry/i) || navigator.userAgent.match(/Windows Phone/i)){
    return true;
  }else {
    return false;
  }
}
function createDateFormat(cdate,name,value,domain,path){
    console.log(cdate);
    var dt = new Date(cdate);
    var year = dt.getUTCFullYear();
    var month = dt.getUTCMonth() + 1;
    if(month < 10){
        month='0'+month;
    }
    var day = dt.getUTCDate();
    if(day < 10){
        day='0'+month;
    }
    var myNewdate= year + "-" + month + "-" + day;
    var today = new Date(myNewdate);
    today.setTime(today.getTime());
    var expires_date = new Date(today.getTime());
    document.cookie = name + '=' + value +';expires=' + expires_date.toGMTString() + //expires.toGMTString()
        ((path) ? ';path=' + path : '') +
        ((domain) ? ';domain=' + domain : '');
}
function setCookieServer(cookiedomain) {
    var xhr = new XMLHttpRequest();
    xhr.open("GET", "https://rss.oneindia.com/scripts/cms/setcookie.php", true);
    xhr.withCredentials = true;
    xhr.onload = function () {
        console.log(xhr.responseText);
        var cdate = JSON.parse(xhr.responseText);
        var name = "swipeShown";
        var value = JSON.parse(xhr.responseText)/1000;
        var domain = cookiedomain;
        var path = '/';
        displaySwipePopup(socialFlag);
        if (socialFlag == 0) {
            createDateFormat(cdate,name,value,domain,path);
        }
    };
    xhr.send();
}
var isMobile = detectmob();
console.log(isMobile);
/*if(isMobile){
    if(!checkUserCookie('swipeShown')){
        setCookieServer(socialdomain);
    }
}*/
/*Swipe Popup Code - Ends*/
var adPromoArray = {"en": [{"Text":"My City News","url":"https://www.oneindia.com/city/","image":"city.jpg"},{"text":"Know your Politicians","url":"https://www.oneindia.com/politicians/","image":"politics.jpg"},{"text":"Lok Sabha Elections 2019","url":"https://www.oneindia.com/lok-sabha-election-2019/","image":"lok-sabha-elections-2019.jpg"}],"bn": [{"Text":"My City News","url":"https://www.oneindia.com/city/","image":"city.jpg"},{"text":"Know your Politicians","url":"https://www.oneindia.com/politicians/","image":"politics.jpg"},{"text":"Lok Sabha Elections 2019","url":"https://bengali.oneindia.com/lok-sabha-election-2019/","image":"lok-sabha-elections-2019.jpg"}], "gu": [{"Text":"My City News","url":"https://www.oneindia.com/city/","image":"city.jpg"},{"text":"Know your Politicians","url":"https://www.oneindia.com/politicians/","image":"politics.jpg"},{"text":"Lok Sabha Elections 2019","url":"https://gujarati.oneindia.com/lok-sabha-election-2019/","image":"lok-sabha-elections-2019.jpg"}], "hi": [{"Text":"My City News","url":"https://hindi.oneindia.com/city/","image":"city.jpg"},{"text":"Know your Politicians","url":"https://hindi.oneindia.com/politicians/","image":"politics.jpg"},{"text":"Lok Sabha Elections 2019","url":"https://hindi.oneindia.com/lok-sabha-election-2019/","image":"lok-sabha-elections-2019.jpg"}],"kn": [{"Text":"My City News","url":"https://kannada.oneindia.com/news/city/","image":"city.jpg"},{"text":"Know your Politicians","url":"https://kannada.oneindia.com/politicians/","image":"politics.jpg"},{"text":"Lok Sabha Elections 2019","url":"https://kannada.oneindia.com/lok-sabha-election-2019/","image":"lok-sabha-elections-2019.jpg"}],"ml": [{"Text":"My City News","url":"https://malayalam.oneindia.com/news/localnews/","image":"city.jpg"},{"text":"Know your Politicians","url":"https://malayalam.oneindia.com/politicians/","image":"politics.jpg"},{"text":"Lok Sabha Elections 2019","url":"https://malayalam.oneindia.com/lok-sabha-election-2019/","image":"lok-sabha-elections-2019.jpg"}],"ta": [{"Text":"My City News","url":"https://tamil.oneindia.com/news/city/","image":"city.jpg"},{"text":"Know your Politicians","url":"https://tamil.oneindia.com/politicians/","image":"politics.jpg"},{"text":"Lok Sabha Elections 2019","url":"https://tamil.oneindia.com/lok-sabha-election-2019/","image":"lok-sabha-elections-2019.jpg"}],"te": [{"Text":"My City News","url":"https://telugu.oneindia.com/news/city/","image":"city.jpg"},{"text":"Know your Politicians","url":"https://telugu.oneindia.com/politicians/","image":"politics.jpg"},{"text":"Lok Sabha Elections 2019","url":"https://telugu.oneindia.com/lok-sabha-election-2019/","image":"lok-sabha-elections-2019.jpg"}]};
(function (window, document, undefined) {
  var fillBottomAd = function (divElem) {
    var min = 0;
    var max = adPromoArray[sitelang].length - 1;
    var randomnumber = Math.floor(Math.random() * (max - min + 1)) + min;
    console.log(randomnumber);
    var str = channelHost;
    var chuncks = str.match(/.{1,2}/g);
    var new_value = chuncks.join("-");
    var camp='';
    if(randomnumber==0){
    	camp = 'FallBack-InHouse-City';
    }else if(randomnumber==1){
    	camp = 'FallBack-InHouse-Politicians';
    }else if(randomnumber==2){
    	camp = 'FallBack-InHouse-Elections';
    }
    var trackingurl = 'utm_medium=Mobile&utm_source='+new_value+'&utm_campaign='+camp;
    var text = adPromoArray[sitelang][randomnumber]['text'];
    var url = adPromoArray[sitelang][randomnumber]['url']+'?'+trackingurl;
    var image = 'https://rss.oneindia.com/images/ads/'+sitelang+'/'+adPromoArray[sitelang][randomnumber]['image'];
    var finalHtml = '<a href="'+url+'" target="_blank"><img src="'+image+'" alt="'+text+'" /></a>';
    document.getElementById(divElem).innerHTML=finalHtml;
  }
  window.fillBottomAd = fillBottomAd;
})(window, document);

var trackUrl = function(){
    var adunitpath = document.getElementById('capmaignLink').getAttribute('data-adunitpath');
    var hostname = document.getElementById('capmaignLink').getAttribute('data-host');
    var groupName = "Inarticle-2";
    var device_type  = document.getElementById('capmaignLink').getAttribute('data-deviceType');
    var url  = document.getElementById('capmaignLink').getAttribute('data-url');
    var requestType= 'click';
    var promise1 = getPromiseResponse(adunitpath,hostname,groupName,device_type,requestType);
    promise1.then(function(result){
        console.log(result);
    },function(error){
        console.log('error promise 1:', error);
    });
};
var getPromiseResponse = function(adunitpath,hostname,groupName,device_type,requestType){
    var promise1 = new Promise(function(resolve, reject){
    var ajaxRequest = new XMLHttpRequest();
      ajaxRequest.addEventListener("load", function(){
        if(this.status === 200){
          resolve(this);
        } else {
          reject(this);
        }
      });
      var ajaxUrl = "https://rss.oneindia.com/scripts/cms/adRenderingDetails.php?website_name="+hostname+"&grp_name="+groupName+"&slot_id="+adunitpath+"&device_type="+device_type+"&status=Clicked&request_type="+requestType;
      ajaxRequest.open("GET",ajaxUrl);
      /*ajaxRequest.setRequestHeader("X-Requested-With", "XMLHttpRequest");
      ajaxRequest.onreadystatechange = function() {
                if (ajaxRequest.readyState == 4 && ajaxRequest.status == 200) {
                 // 4th state is the last:
                }
        };*/
      ajaxRequest.send();
    });
    return promise1;
  };
var getDisplayCount = function(){
    var adunitpath = document.getElementById('capmaignLink').getAttribute('data-adunitpath');
    var hostname = document.getElementById('capmaignLink').getAttribute('data-host');
    var groupName = "Inarticle-2";
    var device_type  = document.getElementById('capmaignLink').getAttribute('data-deviceType');
    var url  = document.getElementById('capmaignLink').getAttribute('data-url');
    var requestType= 'display';
    var promise1 = getPromiseResponse(adunitpath,hostname,groupName,device_type,requestType);
    promise1.then(function(result){
        console.log(result);
    },function(error){
        console.log('error promise 1:', error);
    });
};
var adnarticle2PromoArray = {"en": [{"url":"https://dailyhunt.page.link/47bd","image":"oi-inarticle2-eng1.jpg"},{"url":"https://dailyhunt.page.link/47bd","image":"oi-inarticle2-eng2.jpg"},{"url":"https://dailyhunt.page.link/47bd","image":"oi-inarticle2-eng3.jpg"}],"hi":[{"url":"https://dailyhunt.page.link/5WrR","image":"oi-inarticle2-hin1.jpg"},{"url":"https://dailyhunt.page.link/5WrR","image":"oi-inarticle2-hin2.jpg"},{"url":"https://dailyhunt.page.link/5WrR","image":"oi-inarticle2-hin3.jpg"},{"url":"https://dailyhunt.page.link/5WrR","image":"oi-inarticle2-hin4.jpg"},{"url":"https://dailyhunt.page.link/5WrR","image":"oi-inarticle2-hin5.jpg"}],"ta":[{"url":"https://dailyhunt.page.link/3EvT","image":"oi-inarticle2-tam1.jpg"},{"url":"https://dailyhunt.page.link/3EvT","image":"oi-inarticle2-tam2.jpg"},{"url":"https://dailyhunt.page.link/3EvT","image":"oi-inarticle2-tam3.jpg"},{"url":"https://dailyhunt.page.link/3EvT","image":"oi-inarticle2-tam4.jpg"},{"url":"https://dailyhunt.page.link/3EvT","image":"oi-inarticle2-tam5.jpg"},{"url":"https://dailyhunt.page.link/3EvT","image":"oi-inarticle2-tam6.jpg"}],"bn":[{"url":"https://dailyhunt.page.link/nqXN","image":"oi-inarticle2-ben1.jpg"},{"url":"https://dailyhunt.page.link/nqXN","image":"oi-inarticle2-ben2.jpg"},{"url":"https://dailyhunt.page.link/nqXN","image":"oi-inarticle2-ben3.jpg"},{"url":"https://dailyhunt.page.link/nqXN","image":"oi-inarticle2-ben4.jpg"}],"gu":[{"url":"https://dailyhunt.page.link/qfyX","image":"oi-inarticle2-guj1.jpg"},{"url":"https://dailyhunt.page.link/qfyX","image":"oi-inarticle2-guj2.jpg"},{"url":"https://dailyhunt.page.link/qfyX","image":"oi-inarticle2-guj3.jpg"}],"kn":[{"url":"https://dailyhunt.page.link/bn6i","image":"oi-inarticle2-kan1.jpg"}],"ml":[{"url":"https://dailyhunt.page.link/83SJ","image":"oi-inarticle2-mal1.jpg"}],"te":[{"url":"https://dailyhunt.page.link/NYJg","image":"oi-inarticle2-tel1.jpg"}]}; 
(function (window, document, undefined) {
  var fillInarticle2Ad = function (divElem,adunitPath,hostname,device_type) {
    var min = 0;
    var max = adnarticle2PromoArray[sitelang].length-1;
    var randomnumber = Math.floor(Math.random() * (max - min + 1)) + min;
    console.log(randomnumber);
    var str = channelHost;
    var chuncks = str.match(/.{1,2}/g);
    var new_value = chuncks.join("-");
    var camp='';
    var url = adnarticle2PromoArray[sitelang][randomnumber]['url'];
    var image = 'https://rss.oneindia.com/images/ads/'+sitelang+'/'+adnarticle2PromoArray[sitelang][randomnumber]['image'];
    var finalHtml = '<a href="'+url+'" onclick="trackUrl()" data-adunitpath="'+adunitPath+'" data-url="'+url+'" data-host="'+hostname+'" data-deviceType="'+device_type+'" id="capmaignLink" target="_blank"><img src="'+image+'" style="width:300px;margin:0 auto;"/></a>';
    document.getElementById(divElem).innerHTML=finalHtml;
    getDisplayCount();
  }
  window.fillInarticle2Ad = fillInarticle2Ad;
})(window, document);
//For OpenX AD logic
var jsloadFlagInhouse=0;
var oicontent = {
    scriptUrl : 'https://content.oneindia.com/cms/oi-content.php?oitype=fallbackjs&oisource=myconasyncjs',//Needs to be changed where required.
    generateInhouseScript : function(finalScriptUrl){
        var backupInhouse = document.createElement("script");
        backupInhouse.async=true;
        backupInhouse.type = "text/javascript";
        backupInhouse.src = finalScriptUrl;
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(backupInhouse, s);
    },
    removeJS : function(filename){
     var tags = document.getElementsByTagName('script');
     for (var i = tags.length; i >= 0; i--){ 
      if (tags[i] && tags[i].getAttribute('src') != null && tags[i].getAttribute('src').indexOf(filename) != -1)
       tags[i].parentNode.removeChild(tags[i]);
     }
    },
    createInhouseCampaign : function (elemId,loc,zoneId,reviveId) {
        var ins_elem = document.createElement("ins");
        ins_elem.setAttribute("data-revive-target", "_blank");
        ins_elem.setAttribute("data-revive-zoneid",zoneId);
        ins_elem.setAttribute("data-revive-id",reviveId);
        var refnode = document.getElementById(elemId);
        document.getElementById(elemId).innerHTML='';
        document.getElementById(elemId).style.display='block';
        document.getElementById(elemId).appendChild(ins_elem);
        var finalScriptUrl = oicontent.scriptUrl;
        finalScriptUrl = finalScriptUrl+'&loc='+loc; 
        oicontent.removeJS(finalScriptUrl);
        oicontent.generateInhouseScript(finalScriptUrl);
    }
};
(function (window, document, undefined) {
  var renderInhouseCampaign = function (elemId,loc) {
    console.log("BackFill - "+elemId);
    if(document.getElementById(elemId)){
        var zone_id     = document.getElementById(elemId).parentNode.getAttribute('data-zoneid');
        if(zone_id!=null && zone_id !='' && zone_id != undefined){
            var revive_id   = document.getElementById(elemId).parentNode.getAttribute('data-reviveid');
            var jsonzone = JSON.parse(zone_id);
            console.log("jsonzone - "+zone_id);
            var jsonzone_id = jsonzone.backfill;
            var jsonrevive = JSON.parse(revive_id);
            var jsonrevive_id = jsonrevive.backfill;
            oicontent.createInhouseCampaign(elemId,loc,jsonzone_id,jsonrevive_id);
        }
    }
  }
  window.renderInhouseCampaign = renderInhouseCampaign;
})(window, document);
